---
title: éšé©¬å°”å¯å¤«æ¨¡å‹HMM
date: '2022/11/23 21:12:53'
top_img: 'https://pic.hycbook.com/i//hexo/post_imgs/è•¾å§†1.webp'
cover: 'https://pic.hycbook.com/i//hexo/post_cover/è•¾å§†1.webp'
categories:
  - machine_learning
tags:
  - æœºå™¨å­¦ä¹ 
  - éšé©¬å°”å¯å¤«æ¨¡å‹HMM
mathjax: true
description: æœºå™¨å­¦ä¹ ä¹‹éšé©¬å°”å¯å¤«æ¨¡å‹HMM
abbrlink: 4987
---

---



# éšé©¬å°”å¯å¤«HMM

## å®šä¹‰

> [ä¸€ç«™å¼è§£å†³ï¼šéšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆHMMï¼‰å…¨è¿‡ç¨‹æ¨å¯¼åŠå®ç°](https://zhuanlan.zhihu.com/p/85454896)
>
> [å…³äºHMMã€MEMMã€CRFçš„ä¸€äº›çŸ¥è¯†æ•´ç†æ•´ç†](https://zhuanlan.zhihu.com/p/172317251)
>
> [å›¾è§£éšé©¬å°”å¯å¤«æ¨¡å‹HMM_é€šä¿—æ˜“æ‡‚](https://www.jianshu.com/p/1a45adecaf8c)

HMMæ˜¯ç”Ÿæˆæ¨¡å‹



## ä¸‰è¦ç´ 

> éšé©¬å°”å¯å¤«ä¸‰è¦ç´ 

éšé©¬å°”å¯å¤«æ¨¡å‹ç”±`åˆå§‹çŠ¶æ€æ¦‚ç‡`$\pi$ã€`çŠ¶æ€è½¬ç§»çŸ©é˜µ`$A$ã€`è§‚æµ‹æ¦‚ç‡çŸ©é˜µ`(æˆ–è€…å«å‘å°„çŸ©é˜µ)$B$å†³å®šï¼Œè®°ä½œ
$$
\lambda = (\pi, A, B)
$$
å…¶ä¸­$\pi$çš„ç»´åº¦ä¸º$N$ï¼Œ$A$çš„ç»´åº¦ä¸º$N \times N$ï¼Œ$B$çš„ç»´åº¦ä¸º$N \times M$

## ä¸‰ä¸ªå‡è®¾

1. `é©¬å°”ç§‘å¤«æ€§å‡è®¾`: $t$æ—¶åˆ»çš„çŠ¶æ€å‡ºç°çš„æ¦‚ç‡åªå’Œ$t-1$æ—¶åˆ»çš„çŠ¶æ€æœ‰å…³
   $$
   P(x_t | x_{t-1}, x_{t-1}, \cdots, x_1) = P(x_t | x_{t-1})
   $$

2. `é½æ¬¡é©¬å°”å¯å¤«å‡è®¾`(å‡è®¾1)
   $$
   \begin{align}
   & P(x_1, \cdots , x_{t}, z_t=q_i, z_{t+1}=q_j | \lambda) 
   = P(z_{t+1}=q_j | x_1, \cdots , x_t, z_t=q_i , \lambda) P(x_1, \cdots , x_t, z_t =q_i | \lambda) 
   \\
   &= P(z_{t+1} = q_j | z_t=q_i) P(x_1, \cdots , x_t, z_t=q_i | \lambda) = a_{ij} \alpha _{t}(i)
   \end{align}
   $$
   
3. `è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾`(å‡è®¾2)
   $$
   P(x_{t+1} | x_1, \cdots , x_{t}, z_t=q_i, z_{t+1}=q_j , \lambda) = P(x_{t+1} | z_{t+1}=q_j ) = b_j(x_{t+1})
   $$

å‡è®¾1å’Œå‡è®¾2åœ¨å‰åå‘ç®—æ³•æ¨å¯¼ä¸Šæœ‰ç”¨åˆ°

## æ¦‚ç‡åŸºç¡€

> è”åˆæ¦‚ç‡

è”åˆæ¦‚ç‡æŒ‡çš„æ˜¯åŒ…å«å¤šä¸ªæ¡ä»¶ä¸”**æ‰€æœ‰æ¡ä»¶åŒæ—¶æˆç«‹**çš„æ¦‚ç‡ï¼Œè®°ä½œ
$$
P(X=a,Y=b)=P(a,b)=P(a \cap b)
$$

> è¾¹ç¼˜æ¦‚ç‡

ä»…ä¸å•ä¸ªéšæœºå˜é‡æœ‰å…³çš„æ¦‚ç‡ï¼Œè®°ä½œ
$$
P(X=a)=P(Y=b)
$$

> æ¡ä»¶æ¦‚ç‡

æ¡ä»¶æ¦‚ç‡è¡¨ç¤ºåœ¨æ¡ä»¶$Y=b$æˆç«‹çš„æƒ…å†µä¸‹ï¼Œ$X=a$çš„æ¦‚ç‡ï¼Œè®°ä½œ
$$
P(X=a|Y=b)=P(a|b)
$$
å…·æœ‰æ€§è´¨ï¼šåœ¨æ¡ä»¶$Y=b$ä¸‹$X$çš„æ¡ä»¶åˆ†å¸ƒï¼Œä¹Ÿæ˜¯ä¸€ç§$X$çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç©·ä¸¾$X$çš„å¯å–å€¼ä¹‹åï¼Œæ‰€æœ‰è¿™äº›å€¼å¯¹åº”çš„æ¦‚ç‡ä¹‹å’Œä¸º$1$ï¼Œå³:
$$
\sum _{a}{P(X=a|Y=b)} = 1
$$

> ğŸŒ¿è”åˆæ¦‚ç‡ã€è¾¹ç¼˜æ¦‚ç‡ä¸æ¡ä»¶æ¦‚ç‡ä¹‹é—´çš„å…³ç³»: è”=è¾¹*æ¡

$$
P(X=a|Y=b) = \frac {P(X=a,Y=b)}{P(Y=b)}
$$

å¯ä»¥ç†è§£æˆåœ¨$Y$é€‰ä¸­$b$çš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶$X$é€‰ä¸­$b$çš„æ¦‚ç‡å°±æ˜¯è”åˆæ¦‚ç‡ï¼Œè¡¨ç¤ºä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³

ğŸŒ°ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰3ä¸ªç›’å­ï¼Œæ¯ä¸ªç›’å­ä¸­æœ‰ç™½è‰²å’Œçº¢è‰²ä¸¤ç§é¢œè‰²çš„çƒï¼Œé‚£ä¹ˆä»ç¬¬äºŒä¸ªç›’å­ä¸­å–å‡ºç™½çƒçš„æ¦‚ç‡ï¼Œç­‰ä»·äºæŠ½åˆ°ç¬¬äºŒä¸ªç›’å­çš„æ¦‚ç‡$\times$ç¬¬äºŒä¸ªç›’å­ä¸­æŠ½åˆ°ç™½è‰²æ±‚çš„æ¦‚ç‡

> è´å¶æ–¯å…¬å¼

* **å…ˆéªŒæ¦‚ç‡**ï¼šçŸ¥é“åŸå› æ¨ç»“æœçš„ï¼ŒP(åŸå› )ã€P(ç»“æœ|åŸå› )ç­‰
* **åéªŒæ¦‚ç‡**ï¼šæ ¹æ®ç»“æœæ¨åŸå› çš„ï¼ŒP(åŸå› |ç»“æœ)ç­‰



# HMMçš„ä¸‰ä¸ªé—®é¢˜

HMMçš„åŸºæœ¬é—®é¢˜ä¸€å…±æœ‰ä¸‰ä¸ª:

- `æ¦‚ç‡è®¡ç®—`ï¼šç»™å®šå‚æ•°$ \lambda =( \pi , A, B) $å’Œè§‚æµ‹åºåˆ—$ X=(x_1,x_2, \cdots ,x_T) $ï¼Œè®¡ç®—è§‚æµ‹åºåˆ—$ X $çš„æ¡ä»¶æ¦‚ç‡$ P(X|\lambda)$
- `å‚æ•°å­¦ä¹ `ï¼šç»™å®šè§‚æµ‹åºåˆ—$ X $ï¼Œåæ¨å‚æ•°$\pi$ã€$A$ã€$B$
- `è§£ç é—®é¢˜`ï¼šç»™å®šå‚æ•°$\lambda$å’Œè§‚æµ‹åºåˆ—$ X=(x_1,x_2, \cdots ,x_T) $ï¼Œæ±‚å¯èƒ½æ€§æœ€å¤§çš„$ Z=(z_1, \cdots ,z_T)$

## æ¦‚ç‡è®¡ç®—

> HMMæ¨¡å‹å®šä¹‰

ğŸŒ±å‡è®¾æœ‰4ä¸ªç›’å­ï¼Œæ¯ä¸ªç›’å­é‡Œé¢æœ‰ä¸åŒæ•°é‡çš„çº¢ã€ç™½ä¸¤ç§é¢œè‰²çš„çƒï¼Œå…·ä½“å¦‚ä¸‹è¡¨

| ç›’å­ç¼–å· | 1    | 2    | 3    | 4    |
| -------- | ---- | ---- | ---- | ---- |
| çº¢çƒæ•°   | 5    | 3    | 6    | 8    |
| ç™½çƒæ•°   | 5    | 7    | 4    | 2    |

ç°åœ¨ä»è¿™äº›ç›’å­ä¸­æŠ½å–$T$ä¸ªçƒï¼Œæ¯æ¬¡æŠ½å–åè®°å½•é¢œè‰²ï¼Œå†æ”¾å›åŸç›’å­ï¼Œ

åºåˆ—å¦‚ä¸‹å›¾æ‰€ç¤º

![img](https://pic.hycbook.com/i//hexo/bk_resources/machine_learning/éšé©¬å°”å¯å¤«æ¨¡å‹HMM/HMMæ¨¡å‹.webp)

å…¶ä¸­$z_i$ä»£è¡¨ç¬¬$i$ä¸ª`éšåºåˆ—å€¼`ï¼Œ$q_i$ä»£è¡¨ç¬¬$i$ä¸ª`éšçŠ¶æ€`ï¼Œ$x_i$ä»£è¡¨ç¬¬$i$ä¸ª`è§‚æµ‹åºåˆ—å€¼`ï¼Œæ³¨æ„

* `éšåºåˆ—å€¼`æŒ‡çš„æ˜¯ç¬¬å‡ ä¸ªä½ç½®ï¼Œæ¯”å¦‚ç¬¬å‡ ä¸ªç›’å­ã€æˆ–è€…ç¬¬å‡ ä¸ªå•è¯
* `éšçŠ¶æ€`æŒ‡çš„æ˜¯ç¬¬å‡ ä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚çº¢çƒè¿˜æ˜¯ç™½çƒï¼Œæˆ–è€…åè¯è¿˜æ˜¯åŠ¨è¯

æ­¤æ—¶$z_t = q_i$è¡¨è¾¾çš„å«ä¹‰å°±æ˜¯$t$æ—¶åˆ»ï¼ŒæŠ½å–ç¬¬$q_i$ä¸ªç›’å­ï¼Œå› ä¸ºæœ‰$4$ä¸ªç›’å­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œ$i={1,2,3,4}$

å¯¹åº”å–åˆ°çš„çƒçš„é¢œè‰²å¯ä»¥è®°ä¸º$x_i$ï¼Œå…¶ä¸­$x_i \in {ç™½è‰², çº¢è‰²}$

### ğŸœå‰å‘æ¦‚ç‡

> å®šä¹‰

å‰å‘æ¦‚ç‡$ \alpha _t (i) $ï¼Œå®ƒæ˜¯$t$æ—¶åˆ»çš„çŠ¶æ€ä»¥åŠ$1, 2, \cdots , t$æ—¶åˆ»çš„è§‚æµ‹åœ¨ç»™å®šå‚æ•°ä¸‹çš„`è”åˆæ¦‚ç‡`
$$
\alpha _t(i) = P(x_1, x_2, \cdots , x_t , z_t =q_i | \lambda)
$$
ä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­æ ‡è®°çš„é‚£ä¸€éƒ¨åˆ†ï¼Œ$ \alpha _t (i) $è¡¨ç¤ºçš„æ˜¯åœ¨$t$æ—¶åˆ»ï¼ŒéšçŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡

> å‰å‘æ¦‚ç‡åˆå€¼

æ ¹æ®å®šä¹‰å¯ä»¥å¾—åˆ°åˆå€¼:
$$
\alpha _1 (i) = P(x_1,z_1 = q_i | \lambda) = P(z_1=q_i | \lambda)P(x_1|z_1=q_i, \lambda) = \pi _i b_i(x_1)
$$
å…¶ä¸­$P(x_1|z_1=q_i, \lambda)$è¡¨è¾¾çš„æ˜¯ï¼Œç»™å®š$\lambda$å’ŒçŠ¶æ€$z_1=q_i$çš„æƒ…å†µä¸‹ï¼Œè§‚æµ‹å€¼æ˜¯$x_1$çš„æ¦‚ç‡

å‡è®¾æ­¤æ—¶$x_1=ç™½è‰²$ï¼Œè¿™é‡Œå¯ä»¥é€šä¿—ç†è§£ä¸º$z_1$è¡¨ç¤ºçš„ç¬¬$1$ä¸ªç›’å­ï¼Œå³ä»ç¬¬ä¸€ä¸ªç›’å­ä¸­å–å‡ºç™½çƒçš„æ¦‚ç‡

åŒæ—¶$ b_i(x) $è¡¨ç¤ºç”±çŠ¶æ€$ q_i $ç”Ÿæˆç»™å®šè§‚æµ‹æ•°æ®çš„æ¦‚ç‡ï¼Œä¾‹å¦‚è®¾$ t $æ—¶åˆ»è§‚æµ‹æ•°æ®$ x_t=v_j $ï¼Œæœ‰
$$
b_i(x_t) = b_i(x_t=v_j)=P(x_t=v_j|z_t=q_i)=b_{ij}
$$
ä¸Šè¿°ç”¨åˆ°çš„å…¬å¼ä¸ºä¸º`æ¦‚ç‡åŸºç¡€`éƒ¨åˆ†çš„çŸ¥è¯†

> æ¨å¯¼é€’æ¨å…¬å¼

ç”±å‰å‘æ¦‚ç‡$ \alpha _t (i) $ç»§ç»­æ¨å¯¼å¯ä»¥å¾—åˆ°$ \alpha _T (i) $
$$
\alpha _T(i) = P(x_1, x_2, \cdots , x_T , z_T =q_i | \lambda) = P(X,z_T=q_i | \lambda)
$$
æ ¹æ®è¿™ä¸ªå…¬å¼ï¼Œéå†$ z_T $çš„å–å€¼æ±‚å’Œï¼Œå¯ä»¥å¾—åˆ°$X$çš„`è¾¹é™…æ¦‚ç‡`
$$
\sum _{i=1}^{N}{\alpha _T(i)} = \sum _{i=1}^{N}{P(X,z_T=q_i | \lambda)} = P(X|\lambda)
$$
å…¶ä¸­$N$è¡¨ç¤ºçš„æ˜¯`çŠ¶æ€æ•°é‡`ï¼Œæ¯”å¦‚ç›’å­ä¸­åªæœ‰çº¢çƒå’Œç™½çƒï¼Œå³çŠ¶æ€é›†åˆä¸º$\{ç™½çƒ, çº¢çƒ\}$ï¼Œæ­¤æ—¶$N=2$

ç”±å‰å‘æ¦‚ç‡$$ \alpha _t (i) $$æ¨å¯¼å¯ä»¥å¾—åˆ°$$ \alpha _{t+1} (j) $$
$$
\alpha _{t+1}(j) = P(x_1, x_2, \cdots , x_{t+1} , z_{t+1} =q_j | \lambda)
$$
å¼•å…¥å˜é‡$z_t=q_i$ï¼Œæ³¨æ„($t+1$æ—¶åˆ»$=$$z_t$æ‰€æœ‰çŠ¶æ€æ±‚å’Œ)ï¼Œæ‰€ä»¥æœ‰
$$
\begin{align}
& \alpha _{t+1}(j) = \sum _{i=1}^{N}{P(x_1, \cdots , x_{t+1}, z_t=q_i, z_{t+1}=q_j | \lambda)} \\
&= \sum _{i=1}^{N}{P(x_{t+1} | x_1, \cdots , x_{t}, z_t=q_i, z_{t+1}=q_j , \lambda)} P(x_1, \cdots , x_{t}, z_t=q_i, z_{t+1}=q_j | \lambda)
\end{align}
$$
æ‰¾åˆ°äº†$t$åˆ°$t+1$æ—¶åˆ»çš„é€’æ¨å…¬å¼ï¼Œåˆ†åˆ«çœ‹ä¸‹å…¬å¼çš„ä¸¤ä¸ªéƒ¨åˆ†

1. å‰åŠéƒ¨åˆ†æ ¹æ®`è§‚æµ‹ç‹¬ç«‹å‡è®¾`
   $$
   P(x_{t+1}| x_1, \cdots, x_t, z_t ,z_{t+1} , \lambda) = P(x_{t+1}|z_{t+1}=q_j)=b_j(x_{t+1})
   $$

2. ååŠéƒ¨åˆ†æ ¹æ®`é½æ¬¡é©¬å°”å¯å¤«å‡è®¾`
   $$
   \begin{align}
   & P(x_1, \cdots , x_{t}, z_t=q_i, z_{t+1}=q_j | \lambda) \\
   & = P(z_{t+1}=q_j | x_1, \cdots , x_t, z_t=q_i , \lambda) P(x_1, \cdots , x_t, z_t =q_i | \lambda) \\
   & = P(z_{t+1} = q_j | z_t=q_i) P(x_1, \cdots , x_t, z_t=q_i | \lambda) = a_{ij} \alpha _{t}(i)
   \end{align}
   $$

å°†ä¸Šè¿°ç»“æœä»£å…¥$\alpha _{t+1}(j)$å¯ä»¥å¾—åˆ°
$$
\alpha _{t+1}(j) = \sum _{i=1}^{N}{a_{ij}* b_j(x_{t+1})* \alpha _{t}(i)}
$$

> æ¡ä»¶æ¦‚ç‡

$$
P(X|\lambda) = \sum _{i=1}^{N}{\alpha _t(i)}
$$



### ğŸåå‘æ¦‚ç‡

> å®šä¹‰

$$
\beta _t(i) = P(x_T, x_{T-1}, \cdots , x_{t+1}  | z_t =q_i, \lambda)
$$

ä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­æ ‡è®°çš„é‚£ä¸€éƒ¨åˆ†ï¼Œ$ \beta _t (i) $è¡¨ç¤ºçš„æ˜¯åœ¨$t$æ—¶åˆ»ï¼ŒéšçŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡

![img](https://pic.hycbook.com/i//hexo/bk_resources/machine_learning/éšé©¬å°”å¯å¤«æ¨¡å‹HMM/HMMåå‘ç®—æ³•.webp)

> åå‘æ¦‚ç‡åˆå€¼ï¼Œå®šä¹‰ä¸º1

$$
\beta _T(1) = \beta _T(2) = \cdots = \beta _T(N) =1
$$
æ ¹æ®åå‘æ¦‚ç‡å®šä¹‰å¯ä»¥æ¨å‡º
$$
\beta _1(i) = P(x_T, x_{T-1}, \cdots , x_2 | z_1=q_i, \lambda)
$$
ç„¶åæ¥çœ‹ä¸Šå¼å’Œè¦è®¡ç®—çš„æ¦‚ç‡$ P(X| \lambda ) $ä¹‹é—´çš„å…³ç³»
$$
\begin{align}
& P(X| \lambda ) = P(x_1, x_2, \cdots , x_T | \lambda) = \sum _{i=1}^{N}{P(x_1, x_2, \cdots , x_T, z_1=q_i | \lambda)} \\
& = \sum _{i=1}^{N}{P(x_1 | x_2, \cdots , x_T, z_1=q_i , \lambda)P(x_2, \cdots , x_T, z_1=q_i | \lambda)} \\
& = \sum _{i=1}^{N}{P(x_1 | z_1=q_i) P(z_1=q_i | \lambda) P(x_T, x_{T-1}, \cdots, x_2 | z_1=q_i, \lambda)}  = \sum _{i=1}^{N}{b_i(x_1) \pi _i \beta _1(i)}
\end{align}
$$
ä¸Šé¢$b_i(x_1) \pi _i$ä¹Ÿå°±æ˜¯$ \alpha _1(i) $çš„å®šä¹‰ï¼Œå®é™…ä¸Šï¼Œå¯¹äºä»»æ„æ—¶åˆ»$ t $ï¼Œå­˜åœ¨ä»¥ä¸‹ç­‰å¼
$$
P(X | \lambda) = \sum _{i=1}^{N}{\alpha _t(i) \beta _t(i)}
$$
æ¥ç€ï¼Œå‡è®¾å·²çŸ¥æ‰€æœ‰çš„$$\beta _{t+1}$$ï¼Œæ¥æ¨å¯¼$$\beta _{t}$$
$$
\begin{align}
& \beta _{t}(i) = P(X_T, \cdots , x_{t+1} | z_t=q_i , \lambda) = \sum _{j=1}^{N}{P(x_T, \cdots , x_{t+1}, z_{t+1} =q_j | z_t=q_i , \lambda)} \\
& = \sum _{j=1}^{N}{P(x_T, \cdots , x_{t+1} | z_{t+1} =q_j , z_t=q_i , \lambda) P(z_{t+1} = q_j | z_t =q_i , \lambda)}
\end{align}
$$
è§‚å¯Ÿä¸Šå¼ï¼Œåéƒ¨åˆ†å®é™…ä¸Šå°±æ˜¯$\alpha _{ij}$ï¼Œè€Œå‰åŠéƒ¨åˆ†ï¼Œæ ¹æ®å‰å‘æ¦‚ç‡ä¸­çš„`è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾`ï¼Œ$z_t$ä¸$x_1, \cdots ,x_T$éƒ½æ˜¯æ— å…³çš„ï¼Œå³ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥çœå»ï¼Œå› æ­¤ç¬¬äºŒéƒ¨åˆ†å¯ä»¥å˜ä¸º
$$
\begin{align}
& P(x_T, \cdots , x_{t+1} | z_{t+1} =q_j , z_t=q_i , \lambda) = P(x_T, \cdots , x_{t+1} | z_{t+1}=q_j , \lambda) \\
& = P(x_{t+1} | x_T, \cdots , x_{t+2}, z_{t+1}=q_j) P(x_T, \cdots , x_{t+2} | z_{t+1}=q_j , \lambda) = b_j(x_{t+1}) \beta _{t+1} (j)
\end{align}
$$
å°†ç»“è®ºä»£å…¥$\beta _t{i}$å¾—åˆ°
$$
\beta _t{i} = \sum _{j=1}^{N}{a_{ij}*b_j(x_{t+1})*\beta _{t+1}(j)}
$$


## å‚æ•°å­¦ä¹ 



## è§£ç é—®é¢˜



