---
title: 机器学习_一元函数微积分
date: '2022/9/10 20:46:25'
top_img: 'https://pic.hycbook.com/i/hexo/post_imgs/蕾姆0.webp'
cover: 'https://pic.hycbook.com/i/hexo/post_cover/蕾姆0.webp'
categories:
  - math
tags:
  - python
  - 机器学习数学
  - 微积分
  - 定积分
  - 常微分
  - 极限和连续
  - 导数微分
mathjax: true
description: 机器学习的数学基础入门知识
swiper_index: 7
abbrlink: 10706
---


---

> 写在前面，本系列主要是对下面这本书做的学习笔记

![](https://pic1.zhimg.com/80/v2-1a36e4e5fb49fe46e99ea3dfddaa9e54_720w.webp)



> [常用数学符号的 LaTeX 表示方法](http://www.mohu.org/info/symbols/symbols.htm)
>
> [Markdown 常用数学符号和公式](https://blog.csdn.net/qq_38253837/article/details/109923758)

# 极限与连续

> 极限是微积分中最基本的概念，也是理解导数与积分等概念的基础。

## 可数集和不可数集

> 初等数学已经对元素数有限的集合进行的系统系统阐述，对无限集有些概念和规则不再适用，即使是常用的自然数集$$ \mathbb {N} $$和实数集$$ \mathbb {R} $$其性质，也需要重新定义

> 基数或势

**集合$$A$$的元素数量称为其`基数或势`，记为$$ |A| $$，对于集合$$ A=\{1,3,5,7\} $$，其基数为$$ |A|=4 $$**

基数为有限值的集合称为`有限集`；基数为无限值的集合称为`无限集`

对于两个有限集，如果集合$$A$$是集合$$B$$的真子集，即$$A \subset B$$，则有$$|A| < |B|$$，而无限集的基数为$$+\infty$$，因此不能直接使用这个规则进行基数比较

考虑正整数集$$\mathbb {N}^+$$，令集合$$A_1$$为所有正奇数组成的集合，集合$$A_2$$为所有正偶数组成的集合。因此有
$$
\mathbb {N}^+=A_1 \cup A_2 \\
A_1 \subset \mathbb {N}^+ \\
A_2 \subset \mathbb {N}^+
$$
但这并不意味着$$|A_2| < \mathbb {N}^+$$

> 双射函数

**对于集合$$A$$和$$B$$，如果集合$$A$$的任意元素$$a$$，在集合$$B$$都有唯一的元素$$b$$通过某种映射关系与之对应，即存在如下的`双射函数`(一对一映射函数) **
$$
b=f(a) \qquad a \in A, b \in B
$$
**则称这两个集合的基数相等**

【1】正整数集与正偶数集的基数相等，因为它们的元素之间存在如下的双射关系
$$
i \rightarrow 2i \qquad i \in \mathbb {N}, 2i \in A_2
$$
【2】集合$$A_1$$和集合$$A_2$$的基数也相等，因为
$$
i \rightarrow i+1 \qquad i \in A_1, i+1 \in A_2
$$
【3】集合$$A=(0,1)$$与整个实数集合$$\mathbb {R}$$等势，因为集合$$D$$实数集合$$\mathbb {R}$$的元素间存在如下的双射函数
$$
f(x)=tan(\pi(x-\frac{1}{2}))
$$
此函数可以将区间$$(0,1)$$拉升至$$(-\infty,+\infty)$$，且存在反函数

![集合A到实数集的映射](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/集合A到实数集的映射.svg)

<center>图 集合A到实数集的映射</center>

【4】区间$$[0,\frac{\pi}{2}]$$与区间$$[0,1]$$是等价的，因为存在双射函数
$$
f=sin(x) \qquad x \in [0, \frac{\pi}{2}]
$$
反过来实数$$\mathbb {R}$$与区间$$(0,1)$$也是等价的，因为存在双射函数
$$
f=\frac{1}{1+e^{-x}} \qquad x \in \mathbb {R}
$$
此函数称为**logistic函数**或**sigmoid函数**，有着优良的性质，在机器学习与深度学习中被广泛使用。

> 可数集和不可数集

`无限集`，可进一步分为`可数集`与`不可数集`，可数集中的每个元素可以用正整数进行编号，即与正整数等势

正整数是可数集，它的每个元素可以写成$$a_n=2n,n=1,\dots,+\infty$$

`可数集定义`：如果存在从正整数集$$\mathbb {N}$$到集合$A$的双射关系$$f:\mathbb {N}^{+} \rightarrow A$$，则集合$$A$$是可数的

1. 整数集是可数的，因为存在双射函数$$abs(x)$$，将其映射到正整数集

2. 有理数集也是可数集，因为所有的有理数都可以写成两个整数相除的形式$$\frac{p}{q}(q \neq 0)$$

整数集和有理数集，这里的离散和可数等价，任何可数集在数轴上的"长度"为0。

`不可数集`：无理数、实数集$$\mathbb {R}$$和长度不为0的实数区间都是不可数的，其中的元素是连续的，它们在数轴上是稠密的或者说连续的，如$$\sqrt {2}$$，圆周率$$\pi$$以及以自然对数底数$$e$$都是无理数，不可数集在数轴上的"长度"不为0。

可数和不可数的概念将用于定积分中函数的可积性，以及概率论中的离散型和连续型随机变量等概念中

## 数列的极限

### 极限概念与定义

> 数列极限

数列的极限反映了当数列元素下标趋向于$$+\infty$$时数列项取值的趋势

`数列极限定义`: 对于数列$$\{ a_n \}$$以及某一实数$$a$$，如果对于任意给定的$$\epsilon$$都存在正整数$$N$$，使得对于任意满足$$n \gt N$$的$$n$$都有下面的不等式成立
$$
|a_n - a| \lt \epsilon \tag{1}
$$
则称此数列$${a_n}$$的极限为$$a$$，或称其收敛于$$a$$，数列的极限记为$$\lim _{n \rightarrow +\infty }{a_n}$$

`直观解释`: 当$$n$$增加时数列的值$$a_n$$无限趋近于$$a$$，可接近到任意指定的程度，由$$\epsilon$$控制，当数列的极限不存在，则称该数列发散，如果数列的极限存在，则其值必唯一

> 证明数列极限存在且为某一值的方法是证明公式(1)成立

并非所有的数列都存在极限

1. 数列$$\{sin(n \pi + \frac{\pi}{2})\}$$，当$$n \rightarrow + \infty$$时，数列的值在-1与1之间振荡
2. 数列$$\{n\}$$，当$$n \rightarrow + \infty$$时，数列的值趋向于$$+ \infty$$，极限也不存在

> 数列极限的四则运算

$$
\lim_{n \rightarrow + \infty}{a_n \pm b_n} = \lim_{n \rightarrow + \infty}{a_n} \pm \lim_{n \rightarrow + \infty}{b_n} \\
\lim_{n \rightarrow + \infty}{a_n . b_n} = \lim_{n \rightarrow + \infty}{a_n} . \lim_{n \rightarrow + \infty}{b_n} \\
\lim_{n \rightarrow + \infty}{\frac {a_n}{b_n}} = \frac {\lim_{n \rightarrow + \infty}{{a_n}}}{\lim_{n \rightarrow + \infty}{{b_n}}}
$$

计算极限$$\lim_{n \rightarrow + \infty}{(1 + \frac {1}{n})(2 + \frac {1}{n^2})} $$，根据数列极限的四则运算有
$$
\lim_{n \rightarrow + \infty}{(1 + \frac {1}{n})(2 + \frac {1}{n^2})} = \lim_{n \rightarrow + \infty}{(1 + \frac {1}{n})} . \lim_{n \rightarrow + \infty}{(2 + \frac {1}{n^2})} = 1  \times 2 = 2
$$

### 极限存在判定法则

{% tabs 极限存在判定法则 %}
<!-- tab 单调收敛定理 -->

> 数列上界和下界

* **上界**: 对于数列$$a_n$$，如果它的任意元素都满足$$a_n \leq U$$，则称$$U$$为数列的上界，上界不唯一
* **下界**: 对于数列$$a_n$$，如果它的任意元素都满足$$a_n \geq U$$，则称$$U$$为数列的下界

`单调收敛定理`: 如果数列单调递增且存在上界，则极限存在，如果数列单调递减且有下界，则极限存在，即**单调有界的数列收敛**

根据单调收敛定理，可以得到微积分中一个重要极限，对于数列$$a_n=\{ {(1+ \frac{1}{n})}^{n} \}$$的极限为


$$
\lim _{n \rightarrow + \infty}{(1+ \frac{1}{n})}^{n} = e
$$

![单调有界的数列收敛](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/单调有界的数列收敛.svg)


<center>图 单调有界的数列收敛</center>

其中$$e$$为自然对数的底数，约为$$2.71828$$，是数学中最重要的常数之一

`证明`: 证明数列有界和单调递增，收敛于$$e$$

数列$$\{ (1- \frac{1}{n})^{n} \}$$的极限为$$\lim _{n \rightarrow +\infty}{(1- \frac{1}{n})^{n}}= \lim _{n \rightarrow +\infty}{\frac{1}{(1+ \frac{1}{n})^{n}}} \times \lim _{n \rightarrow +\infty}\frac{1}{1+ \frac{1}{n-1}}= \frac{1}{e}$$

这个极限可以用来表示对$$n$$个样本进行$$n$$次有放回等概率抽样，当样本量趋于无穷大时，每个样本一次都没被抽中的概率

**单调有界是数列收敛的充分条件而非必要条件**

![不满足单调有界条件但收敛的数列](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/不满足单调有界条件但收敛的数列.svg)


<center>图 不满足单调有界条件但收敛的数列</center>

<!-- endtab -->

<!-- tab 夹逼定理 -->

`夹逼定理`: 如果对于$$\forall n \in \mathbb {N}$$有$$b_n \leq a_n \leq c_n $$且$$\lim _{n \rightarrow +\infty}{b_n}=\lim _{n \rightarrow +\infty}{c_n}=c$$，则有$$\lim _{n \rightarrow +\infty}{a_n}=c$$，这一结论称为夹逼定理

如果数列无界，则必定发散，**有界是数列收敛的必要条件而非充分条件**，如数列$$\{ (-1)^{n} \}$$有界但不收敛

<!-- endtab -->

{% endtabs %}

## 函数的极限

> 函数极限的严格定义由法国数学家柯西给出: 即当前广泛使用的$\epsilon \mbox{-} s $定义

`领域`: 点$$x_0$$的$$\delta$$领域是指满足不等式$$|x-x_0| \lt \delta$$的所有$$x$$构成的集合，即区间$$(x_0 - \delta,x_0 + \delta)$$，$$\delta$$称为领域的`半径`

`去心领域`: 去心$$\delta$$领域是指满足上式且去掉点$$x_0$$的点构成的集合$$(x_0 - \delta,x_0) \cup (x_0,x_0 + \delta)$$

`函数极限`: 对于函数$$f(x)$$，如果对于任意的$$\epsilon \gt 0$$，均存在$$x_0$$的$$\delta$$去心领域，使得去心领域内所有的$$x$$都有
$$
|f(x)-a| \lt \epsilon \tag{1}
$$
则称函数在$$x_0$$点处的极限为$$a$$，函数在$$x_0$$点处的极限记为
$$
\lim {x \rightarrow +\infty}{f(x)}
$$
`直观解释`: 当自变量$$x$$的值无限接近于$$x_0$$时，函数值$$f(x)$$无限接近于$$a$$

* 即在$$(x_0 - \delta,x_0) \cup (x_0,x_0 + \delta)$$内的函数值都在$$(a- \epsilon, a+ \epsilon)$$区间内

> 证明函数极限的方法和数列类似，核心是证明在区新领域内使得公式(1)$$|f(x)-a| \lt \epsilon$$成立

> 左右极限

一维数轴上有两个方向，变量$$x$$可以从左侧趋近于$$x_0$$，也可以从右侧趋近于$$x_0$$
因此函数的极限分为左极限和右极限，左极限和右极限分别记为
$$
\lim _{x \rightarrow x_0^{-}}{f(x)}=a \qquad \qquad \qquad
\lim _{x \rightarrow x_0^{+}}{f(x)}=a
$$

> 夹逼定理

假设$$I$$是包含点$$a$$的区间，$$f$$、$$g$$、$$h$$为定义在该区间上的函数，如果对所有属于$$I$$但不等于点$$a$$的点$$x$$都有$$g(x) \leq f(x) \leq h(x)$$，且
$$ \lim _{x \rightarrow a}{g(x)} = \lim _{x \rightarrow a}{h(x)} = a $$

则有$$ \lim _{x \rightarrow a}{f(x)} = a $$，这一结论称为`夹逼定理`



> 几个重要极限



* $$\lim _{x \rightarrow 0}{\frac{sin(x)}{x}}=1$$

* $$\lim _{x \rightarrow +\infty}{(\frac{1}{1+x})^{x}}=e$$

* $$\lim _{x \rightarrow +\infty}{xln(1+\frac{1}{x})}=1$$

* $$\lim _{x \rightarrow 0}{\frac{e^x-1}{x}}=1$$

  * 令$$e^x-1=t$$，则$$x=ln(1+t)$$，因此有
    $$
    \lim _{x \rightarrow 0}{\frac{e^x-1}{x}}=\lim _{t \rightarrow 0}{\frac{t}{ln(1+t)}}=1
    $$
    因为有
    $$
    \lim_{x \rightarrow 0}{\frac{(1+x)^a-1}{x}} = \lim_{x \rightarrow 0}{\frac{e^{aln(1+x)}-1}{x}} = \lim_{x \rightarrow 0}{\frac{e^{an(1+x)}-1}{aln(1+x)} . \frac{alx(1+x)}{x}} = a
    $$
    最后可以得到
    $$
    \lim_{x \rightarrow 0}{\frac{(1+x)^a-1}{x}} = a
    $$

* 



## 函数的连续性与间断点

### 连续性

`函数的连续型`通过极限定义，是最基本的性质之一

`函数连续的直观表现`: 如果自变量的改变很小，则因变量的改变也非常小，函数值不会突然发生跳跃

> 函数连续的定义

如果函数$$f(x)$$满足$$\lim _{x \rightarrow a}{f(x)} = f(a)$$，则称它在$$a$$点处连续

> 几何解释

函数连续在该点处的函数曲线没有"断"

> 连续的重要性质

1. 基本初等函数在其定义域内是连续的，包括多项式函数、有理分式函数、指数函数、对数函数、三角函数、反三角函数
2. 绝对值函数在其定义域内也是连续的
3. 由基本初等函数经过有限次四则运算和复合而形成的函数，在其定义域内连续，这样的函数被称为`初等函数`
4. 如果函数$$f(x)$$和$$g(x)$$在定义域内连续，则复合函数$$f(g(x))$$在定义域内连续



{% tabs 充分条件 %}
<!-- tab 第一类间断点 -->

> 跳跃间断点

`跳跃间断点`: 函数在$$x_0$$处的左极限和右极限都**存在，但不相等**
$$
f(x_{0}^{-}) \neq f(x_{0}^{+})
$$
`例子`:  其中$$x=1$$为`跳跃间断点`
$$
f(x) = \left \{
  \begin{aligned}
  x^2, \qquad x \neq 1 \\
  x^2+1, \qquad x=1
  
  \end{aligned}
\right.
$$

![跳跃间断点](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/跳跃间断点.svg)


<center>图 跳跃间断点</center>

> 可去间断点

`可去间断点`: 或者左右极限**相等**，但不等于该点处的函数值
$$
f(x_{0}^{-}) = f(x_{0}^{+}) = f(x_{0})
$$
`例子`:  其中$$x=1$$为`可去间断点`
$$
f(x) = \left \{
  \begin{aligned}
  x^2, \qquad x \neq 1 \\
  2, \qquad x=1
  
  \end{aligned}
\right.
$$

<!-- endtab -->

<!-- tab 第二类间断点 -->

> 函数在$$x_0$$点处的左极限和右极限至少有一个不存在

`例子`: 正切函数$$f(x)=tan(x)$$，在$$x=\frac{k \pi}{2},k=1,2,3, \dots$$处极限值不存在，为`第二类间断点`

![正切函数的第二类间断点](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/正切函数的第二类间断点.svg)


<center>图 正切函数的第二类间断点</center>

`例子`: 反比例函数$$f(x)=\frac{1}{x}$$，$$x=0$$为函数的第二类间断点，在该点处函数的极限不存在

![反比例函数的第二类间断点](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/反比例函数的第二类间断点.svg)


<center>图 反比例函数的第二类间断点</center>

<!-- endtab -->

{% endtabs %}

### 连续函数的性质

> 连续函数具有很多优良的性质

1. 闭区间$$[a,b]$$上的连续函数$$f(x)$$一定存在极大值$$M$$和极小值$$m$$，使得对于该区间任意的$$x$$有$$m \leq f(x) \leq M$$
2. 开区间上的连续函数则不能保证存在极大值和极小值，如反比例函数

> 介值定理

`介值定理`： 如果函数$$f(x)$$在闭区间$$[a,b]$$内连续，$$c$$是介于$$f(a)$$和$$f(b)$$之间的一个数，则存在$$[a,b]$$中的某个点$$x$$，使得$$f(x)=c$$，考虑下图

![介值定理](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/介值定理.svg)


<center>图  介值定理</center>

1. 对于区间$$[-4,4]$$，在左右端点处的函数值分别为$$-64$$和$$64$$，对于任意的$$-64 \leq c \leq 64$$，均存在至少一个点$$x \in [-4,4]$$，使得$$f(x)=c$$

2. 如果$$c=0$$，则曲线必然存在一点$$x$$使得$$f(x)=0$$，这就是方程的根，事实上，$$x=0$$满足此条件

> 介值定理几何意义

函数$$f(x)$$在区间$$[a,b]$$内一定与直线$$y=c$$至少有一个交点，其中$$c$$介于$$f(a)$$和$$f(b)$$之间
介值定理保证至少存在一点使得$$f(x)=c$$，满足此条件的$$x$$可能有多个

> 连续性假设

机器学习与深度学习算法所使用的绝大多数模型，假设函数$$h(c)$$是连续函数，以保证输入变化小的变化不至于导致预测值的突变，这称为`连续性假设`，连续性通常能够保证机器学习算法有更好的泛化性能

## 上确界与下确界

上确界与下确界可看作是集合最大值与最小值的推广

{% tabs 充分条件 %}
<!-- tab 上确界 -->

`上确界`也称为**最小上界**，对于$$\mathbb {R}$$的非空子集$$S$$，如果该集合中的任意元素$$s$$均有$$s \leq t$$，即$$t$$是集合的一个上界，且$$t$$满足吃不等是此不等式条件的最小值，则$$t$$为集合$$S$$的上确界，记为$$sup(S)$$

如果满足此条件的$$t$$不存在，则称为集合的上确界为$$+\infty$$，如果集合的上确界`存在，则必定唯一`

如果集合$$S$$的元素存在最大值，则最大值为其上确界，如闭区间$$[0,1]$$的上确界为1

集合可能不存在最大值，如开区间$$(0,1)$$，其上确界为$$1$$，但不是集合的最大值

`例子`: 

1. 集合$$\{1,2,3,4\}$$是有限集，其上确界为集合元素的最大值，其值为$$4$$
2. 集合$$\frac{n}{n+1}$$是无限可数集，并且该数列单调递增，其上确界为数列的极限$$\lim _{n \rightarrow +\infty}{\frac{n}{n+1}} = 1$$
3. 集合$$\{sin(x),x \in \mathbb {R}\}$$是无限不可数集，其上确界为该函数的极大值$$1$$

> 充分必要条件

集合存在上确界的充分必要条件是集合有上界，实数集$$\mathbb {R}$$的任意非空有界子集$$D$$均存在上确界

<!-- endtab -->

<!-- tab 下确界 -->

`下确界`: 下确界也称为最大下界，$$t$$是集合$$S$$的一个下界，即对$$S$$中的任意元素$$s$$，均有$$s \geq t$$，且$$t$$是最大的下界，则称$$t$$为$$S$$的下确界，记住$inf(S)$

对于闭区间$$[0,1]$$，下确界为$$0$$，对于开区间$$(0,1)$$，其下确界也为$$0$$

`例子`:

1. 集合$$\frac{n}{n+1}$$的下确界为$$\frac{1}{2}$$，在$$n=1$$时取得
2. 集合$$\{sin(x),x \in \mathbb {R}\}$$的下确界为$$-1$$，是函数的最小值

<!-- endtab -->

{% endtabs %}

## 李普希茨连续

> 李普希茨连续

`李普希茨连续`是比连续更强的条件，不但保证了函数值不间断，而且限定了函数的变化速度

给定函数$$f(x)$$，如果对于区间$$D$$任意两点$$a$$、$$b$$都存在常数$$K$$使得下面的不等式成立
$$
|f(a)-f(b)| \leq K|a-b| \tag{1}
$$
则称函数$$f(x)$$在区间$$D$$内满足`李普希茨条件`，也称为`李普希茨连续`

使得公式(1)成立的最小$$K$$值称为`李普希茨常数`，其值与具体的函数有关

如果$$K < 1$$，则称函数$$f(x)$$为`压缩映射`

> 几何意义

在任意两点$$(x_1,f(x_1))$$，$$(x_2,f(x_2))$$处函数割线斜率的绝对值$$|\frac{f(x_2)-f(x_1)}{x_2-x_1}|$$均不大于$$K$$

在任一点$$x_0$$处，曲线$$f(x)$$均夹在直线$$y-f(x_0)=K(x-x_0)$$与$$y-f(x_0)=-K(x-x_0)$$之间，如图所示

![李普希茨连续性](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/李普希茨连续性.svg)



<center>图 李普希茨连续性</center>

向右上倾斜的直线与想做上倾斜的直线分别为$$y=K(x-x_0)+f(x_0)$$与$$y=-K(x-x_0)+f(x_0)$$

`例子`

1. 一次函数$$f(x)=x$$在$$\mathbb {R}$$内是李普希茨连续，因为对于任意的$$a$$和$$b$$都有
   $$
   |f(a)-f(b)|=|a-b| \leq 1 \times |a-b|
   $$
   因此该函数李普希茨连续且李普希茨常数为$$1$$

2. 二次函数$$f(x)=x^2$$在$$\mathbb {R}$$内不是李普希茨连续，因为对于$$\mathbb {R}$$内任意的$$a$$和$$b$$都有
   $$
   |f(a)-f(b)|=|a^2 - b^2| \leq |a-b| \times |a-b|
   $$
   显然不存在常数$$K$$使得任意$$a$$和$$b$$都满足$$|a+b| \leq K$$，因此该函数不是李普希茨连续

3. 函数$$f(x)=\sqrt{x}$$在区间$$[1,+\infty)$$内李普希茨连续

   * 对于区间$$[1,+\infty)$$内任意的$$a$$和$$b$$都有
     $$
     |f(a) - f(b)| = |\sqrt(a) - \sqrt(b)| = \frac{1}{\sqrt(a) + \sqrt(b)} \times |a-b| \leq \frac{1}{2}|a-b|
     $$

   * 区间$$[0,1]$$内$$f(x)=\sqrt{x}$$不是李普希茨连续，对于该区间内任意的$$a$$和$$b$$都有
     $$
     |f(a) - f(b)| = |\sqrt(a) - \sqrt(b)| = \frac{1}{\sqrt(a) + \sqrt(b)} \times |a-b|
     $$
     当$$0 <a, b<1$$时，不存在常数$$K$$满足$$\frac{1}{|\sqrt(a) + \sqrt(b)|} \leq K$$

> 机器学习中的意义

李普希茨连续要求函数在区间上不能有超过线性的变化速度，对于分析和确保机器学习算法的稳定性有重要的作用

## 无穷小量

> 考虑函数极限值为$$0$$的情况

`定义`: 如果函数$$f(x)$$在$$x_0$$的某去心领域内，有定义且
$$
\lim _{x \rightarrow x_0}{f(x)} = 0
$$
则称$$f(x)$$为$$x \rightarrow x_0$$的`无穷小量`

> 虽然它们的极值均为0，但它们之间比值的极限却有几种情况

1. `高阶无穷小`: $$\lim _{x \rightarrow x_0}{\frac{f(x)}{g(x)}} = 0$$，该比值也是无穷小量，例如
   $$
   \lim _{x \rightarrow x_0}{\frac{x^2}{x}} =\lim _{x \rightarrow x_0}{x} = 0
   $$

2. `同阶无穷小`(`等价无穷小`): $$\lim _{x \rightarrow x_0}{\frac{f(x)}{g(x)}} = c, c \neq 0$$，比值的极限为非$0$的有界变量，例如
   $$
   \lim _{x \rightarrow x_0}{\frac{sin(x)}{x}} = 1 \qquad \qquad \qquad
   \lim _{x \rightarrow x_0}{\frac{ln(1+x)}{x}} = 1
   $$
   
3. `低阶无穷小`: $$\lim _{x \rightarrow x_0}{\frac{f(x)}{g(x)}} = \infty$$，比值的极限为无界变量(称为`无穷大量`)，例如
   $$
   \lim _{x \rightarrow x_0}{\frac{x}{x^2}} =\lim _{x \rightarrow x_0}{\frac{1}{x}} = \infty
   $$

4. 

其中`高阶无穷小`记为$$o(.)$$，`等价无穷小`记为$$f(x) \sim g(x)$$

**直观来看这些比值反映了无穷小接近于0时的变化速度快慢**

> 典型的等价无穷小($$x \rightarrow 0$$)

$$
sin(x) \sim x \qquad \qquad
arcsin(x) \sim x \qquad \qquad
tan(x) \sim x \qquad
ln(1+x) \sim x \\\\
e^x-1 \sim x \qquad
1-cos(x) \sim \frac{x^2}{2} \qquad
\sqrt[n]{1+x}-1 \sim \frac{x}{n} \qquad
a^x-1 \sim xlna
$$

等价无穷小在计算极限时起着重要的作用

# 导数与微分

导数是微分学中的核心概念，它决定了可导函数的基本性质，包括**单调性**、**极值**与**凹凸性**。

在机器学习中，绝大多数算法可以归纳为求解最优化的问题，对于连续型优化问题在求解时一般需要使用导数

## 一阶导数

### 定义

> 导数定义

函数的自变量变化值趋向于$$0$$时，函数值的变化量与自变量变化量比值的极限，在$$x$$点处的`导数`为
$$
f'(x) = \lim_{\Delta \rightarrow 0}{\frac{f(x+\Delta x)-f(x)}{\Delta x}} \tag{1}
$$
如果式(1)的极限存在，则称函数在点$x$处可导

除了用$$f'(x)$$表示之外，导数也可写成$$\frac{dy}{dx}$$，即上面的定义也可以写成另一种形式
$$
f'(x)=\lim_{x \rightarrow x_0}{\frac{f(x)-f(x_0)}{x-x_0}} \tag{2}
$$

> 左右导数

类似于极限，导数也可分为`左导数`和`右导数`

左导数是从左侧趋向于$$x$$时的极限
$$
f'_{-}{x} = \lim_{\Delta \rightarrow 0_-}{\frac{f(x+\Delta x)-f(x)}{\Delta x}} \tag{1}
$$
右导数为自变量从右侧趋向于$$x$$时的极限
$$
f'_{+}{x} = \lim_{\Delta \rightarrow 0_+}{\frac{f(x+\Delta x)-f(x)}{\Delta x}} \tag{1}
$$

> 函数可导的`充分必要`条件是左右导数均存在且相等，其`必要`条件是函数连续

如果导数不存在，则称函数**不可导**

### 几何和物理意义

> 几何意义

函数在定义域 内所有点处的导数值构成的函数称为`导函数`，简称`函数`

导数的几何意义是函数在点$$(x,f(x))$$处切线的斜率，反映了函数值在此点处变化的快慢

函数$$f(x)=-(x-1)^2$$在$$x=0.5$$处，根据导数的定义有
$$
f'(0.5) = \lim _{\Delta x \rightarrow 0}{\frac {f(0.5+\Delta x)-f(0.5)}{\Delta x}} 
= \lim _{\Delta x \rightarrow 0}{\frac {-(0.5+\Delta x -1)^2+(0.5-1)^2}{\Delta x}} \\
= \lim _{\Delta x \rightarrow 0}{\frac {-\Delta x^2 +\Delta x -0.25 +0.25 }{\Delta x}} 
= \lim _{\Delta x \rightarrow 0}{(-\Delta x +1)} = 1
$$
因此在该点处的切线斜率为$$1$$，由于切线经过$$(0.5,-0.25)$$，因此切线的方程为$$y+0.25 = 1 \times (x-0.5)$$，即$$y=x-0.75$$，下图为该曲线和对应的切线

![定积分的几何意义](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/定积分的几何意义.svg)

<center>图  导数的几何意义</center>

> 物理意义

导数典型的`物理意义`是瞬时速度

### 差分公式

> 单侧差分公式

如果$$\Delta x$$的值接近于$$0$$，则在点$$x$$处的导数可以用下面的公式近似计算
$$
f'(x) \approx \frac {f(x+\Delta x)}{\Delta x}
$$
称为`单侧差分公式`

> 中心差分公式

根据导数的定义有
$$
\lim _{\Delta x \rightarrow 0} {\frac {f(x+\Delta x)+f(x-\Delta x)}{2 \Delta x}} = 
\lim _{\Delta x \rightarrow 0} {\frac {f(x+\Delta x)+ -f(x) +f(x) - f(x-\Delta x)}{2 \Delta x}} \\
= \lim _{\Delta x \rightarrow 0} {\frac {f(x+\Delta x)-f(x)}{2 \Delta x}} + \lim _{\Delta x \rightarrow 0} {\frac {f(x-\Delta x)-f(x)}{-2 \Delta x}} 
= \frac {1}{2}f'(x)+\frac {1}{2}f'(x) = f'(x)
$$
其中$$\Delta x$$为接近于$$0$$的正数，这称为`中心差分公式`，用于数值计算导数值，因此可用下面的公式近似计算$$x$$点处的一阶导数值
$$
f'(x) =\lim _{\Delta x \rightarrow 0} {\frac {f(x+\Delta x)+f(x-\Delta x)}{2 \Delta x}}
$$

### 基本函数的求导

下表)列出了各种基本初等函数的求导公式

<center>表 基本函数的求导公式</center>

| 基本函数   | 求导公式                                   |
| ---------- | ------------------------------------------ |
| 幂函数     | $$(x^a)' = ax^{a-1}$$                        |
| 指数函数   | $$(e^x)' = e^x$$                             |
| 指数函数   | $$(a^x)' = a^x ln(a)$$                       |
| 三角函数   | $$(sin \, x)' = cos \, x$$                   |
| 三角函数   | $$(cos \, x)' = -sin \, x$$                  |
| 三角函数   | $$(tan \, x)' = sec^{2} \, x$$               |
| 三角函数   | $$(cot \, x)' = -csc^{2} \, x$$              |
| 对数函数   | $$(ln \, x)' = \frac{1}{x}$$                 |
| 反三角函数 | $$(arcsin \, x)' = \frac{1}{\sqrt{1-x^2}}$$  |
| 反三角函数 | $$(arccos \, x)' = -\frac{1}{\sqrt{1-x^2}}$$ |
| 反三角函数 | $$(arctan \, x)' = \frac{1}{1+x^2}$$         |



证明$$(sin \, x)'$$



### 四则运算的求导公式

| 基本运算 | 求导公式                                                     |
| -------- | ------------------------------------------------------------ |
| 加法     | $$(f(x)+g(x))' = f'(x)+g'(x)$$                                 |
| 减法     | $$(f(x)-g(x))' = f'(x)-g'(x)$$                                 |
| 数乘     | $$(cf(x))'=cf'(x)$$                                            |
| 乘法     | $$(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$$                            |
| 除法     | $$(\frac {f(x)}{g(x)})'=\frac {f'(x)g(x)-f(x)g'(x)}{g^{2}{(x)}}$$ |
| 倒数     | $$(\frac {1}{f(x)}) ' = - \frac {f'(x)}{f^{2}{(x)}}$$          |



## 机器学习中常用的函数

> logistic函数可用作神经网络的激活函数

$$
f(x) = ln(1+e^x)
$$

![logistic函数的曲线](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/logistic函数的曲线.svg)


> softplus函数，可看作是函数Relu即$max(0,x)$的光滑近似，该函数的导数为logistic函数

$$
f(x) = ln(1+e^x)
$$

![softplus函数](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/softplus函数.svg)


函数的导数为：
$$
f'(x) = \frac{1}{1+e^x}(1+e^x)' = \frac{e^x}{1+e^x}=\frac{1}{1+e^{-x}}
$$


> Relu函数可用作神经网络的激活函数，在$0$处该函数不可导，在该点处左导数为0，右导数为1

$$
f(x) = \left \{
  \begin{aligned}
  x, \qquad x \gt 0 \\
  0, \qquad x \lt 0
  \end{aligned}
\right.
$$

![Relu函数的曲线](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/Relu函数的曲线.svg)


去掉0点，该函数的导数为：
$$
f'(x) = \left \{
  \begin{aligned}
  1, \qquad x \gt 0 \\
  0, \qquad x \lt 0
  \end{aligned}
\right.
$$

> 绝对值函数，在$0$点处改函数不可导，左导数为-1，右导数为1，去掉该点，此函数的导数为

$$
f(x) = |x|  = \left \{
  \begin{aligned}
  x, \qquad x \geq 0 \\
  -x, \qquad x \lt 0
  \end{aligned}
\right.
$$



绝对值函数常用于构造机器学习算法训练目标函数的`正则化项`

![绝对值函数](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/绝对值函数.svg)


> sgn符号函数，在$0$点处不连续，因此不可导，去掉该点，此函数在所有点处的导数均为0

$$
f(x) = \left \{
  \begin{aligned}
  1, \qquad x \geq 0 \\
  -1, \qquad x \lt 0
  \end{aligned}
\right.
$$

符号函数常用于分类器的预测函数，表示二值化的分类结果，在支持向量机、logstic回归中都被使用

![符号函数](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/符号函数.svg)


如果一个函数所有不可导点的集合为有限集或无限可数集，则称该函数几乎处处可导，本节中的绝对值函数、Relu函数、符号函数均是几乎处处可导的函数，**处处可导保证了在训练时能够使用梯度下降法求解函数的极值**

## 高阶导数

> 定义

对导数连续求导可以得到高阶导数，二阶导数的是一阶导数的导数，记为
$$
f''(x) = \frac{d^2{y}}{dx^{2}}
$$
n阶导数记为
$$
f(n)(x) = \frac{d^n{y}}{dx^{n}}
$$

> 计算$f(x) = x^{m}$的n阶导数

其一阶导数为$f'(x) = mx^{m-1}$，二阶导数为$f''(x) = m(m-1)x^{m-2}$，以此类推，n阶导数为
$$
f^{(n)}{(x)} = m \cdot (m-1) \cdots (m-n+1)x^{m-n}
$$
如果$m=n$，则$f^{(n)}(x) = n!$

> 计算$f(x) = \frac {1}{1-x}$的n阶导数

$$
f^{(n)}(x) = n!(1-x)^{-(n+1)}
$$

> 计算$f(x) = ln(1+x)$的n阶导数

$$
f^{(n)}(x) = (-1)(-2) \cdots (-(n-1))(1+x)^{-n} = (-1)^{(n-1)}(n-1)!(1+x)^{(-n)}
$$

> 计算$f(x) = e^x$的n阶导数

$$
f^{(n)}(x) = e^x
$$

> 计算f(x)= sin(x)的n阶导数

$$
f'(x)=cos(x) \qquad f''(x)=sin(x) \qquad f^{(3)}(x)=-cos(x) \qquad f^{(4)}(x)=sin(x)
$$

根据此规律有
$$
f^{(n)}(x) = sin{(x + \frac {2 \pi}{n})}
$$
类似地，对于余弦函数$f(x)=cos(x)$有
$$
f^{(n)}(x) = cos{(x + \frac {2 \pi}{n})}
$$
`二阶导数的物理意义是加速度`，如果$f(t)$为位移函数，其二阶导数为$t$时刻的加速度
$$
a(t) = f''(t) = v'(t)
$$
其中$a(t)$为$t$时刻的加速度，$v(t)$为$t$时刻的速度

在python语言中，`sympy`库提供了求导的功能

```python
from sympy import *
x = symbols('x')
r = diff(cos(x), x)
print(r)

>>>> -sin(x)
```



## 微分

函数$y=f(x)$在某一区间上有定义，对于区间内的点$x_0$，当$x$变为$x_0 + \Delta x$时，如果函数的增量$\Delta y = f(x_0 + \Delta)-f(x_0)$可以表示成
$$
\Delta y = A \Delta x + o(\Delta x)
$$
其中$A$是不依赖于$\Delta x$的常数，$o(\Delta x)$是$\Delta x$的`高阶无穷小`，则称函数在$x_0$处可微

$A \Delta x$称为函数在$x_0$处的微分，记为$dy$，即$dy = A \Delta x$，$dy$为$\Delta y$的`线性主部`

通常把$\Delta x$称为自变量的微分，记为$dx$，如果函数可微，则导数和微分的关系为$dy = f(x)dx$

> 微分的几何意义是在点$(x_0, f(x_0))$处自变量增加$\Delta x$时切线函数$y = f'(x_0)(x-x_0)+f(x_0)$

> 举例说明微分的计算，对于函数$y=sin(x^2)$

其导数为$y' = 2x \cdot cos(x^2)$，于是可以得到其微分为$dy = 2x \cdot cos(x^2) dx$

> 考虑下复合函数的微分，对于复合函数$z = f(y), y=g(x)$

根据复合函数求导公式有$\frac{dz}{dx}=f'(y)g'(x)$，因此其微分为$dz = f'(y)g'(x)dx$

由于有$dy = g'(x)dx$，因为也可以写成$dz = f'(y)dy$

## 导数与函数的单调性

导数决定了可导函数的重要性质，包括单调性与极值，是研究函数性质的有力工具，由于导数是函数变化率的极限

因此如果在$x$点处它的值为正，则在该点处自变量增大时函数值也增大，如果为负，则自变量增大时函数值减小

假设函数$f(x)$在区间$[a,b]$内连续，在区间$(a,b)$内可导。如果在$(a,b)$内$f'(x) \gt 0$，则函数在$[a,b]$内单调递增；如果在$(a,b)$内$f'(x) \t 0$，则函数在$[a,b]$内单调递减，可以通过拉格朗日中值定理证明

> 对于函数$f(x) = x^3 + 4x^2 -10x +1$

其一阶导数为$f'(x) = 3x^2 +8x -10$，方程$f'(x)=0$的根为$x = \frac{-8 \pm \sqrt{64+120}}{6} = \frac{-4 \pm \sqrt{46}}{3}$

* 在区间$(- \infty , \frac{-4-\sqrt{46}}{3} )$内$f'(x) \gt 0$，函数单调递增
* 在区间$(\frac{-4-\sqrt{46}}{3} , \frac{-4+\sqrt{46}}{3} )$内$f'(x) \lt 0$，函数单调递减
* 在区间$(\frac{-4+\sqrt{46}}{3} , +\infty )$内$f'(x) \gt 0$，函数单调递增

因此在$x= \frac{-4-\sqrt{46}}{3}$处函数有极大值，在$ x = \frac{-4+\sqrt{46}}{3}$处函数有极小值，函数的曲线为

![极大值和极小值演示函数](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/极大值和极小值演示函数.svg)


利用导数可以证明某些不等式，其思路是证明函数在某一区间内单调，因此在区间的端点处取得极值

> 证明当$x>0$时不等式$ln(x) \le x-1 $成立

构造函数$f(x) = x-1-ln(x)$，其导数为$f'(x) = 1- \frac{1}{x}$

* 当$x \lt 1$时有$f'(x) \lt 0$，函数单调递减
* 当$x \gt 1$时有$f'(x) \gt 0$，函数单调递增

1是函数的极小值点，且$f(1)=0$，因此不等式成立

## 极值判别法则

> 极值定义，这里指的是局部极值

函数$f(x)$在区间$I$内有定义，$x_0$是该区间内的一个点

* 如果存在$x_0$的一个$\delta $领域，对于该领域内任意一点$x$都有$f(x_0) \ge f(x)$，则称$x_0$是该函数的`极大值`
* 如果领域内任意一点$x$都有$f(x_0) \le f(x)$，则称$x_0$是该函数的`极小值`

极大值和极小值统称为`极值`

* 如果存在$x_0$的一个$\delta $领域，对于该领域内任意一点$x$都有$f(x_0) \gt f(x)$，则称$x_0$是该函数的`严格极大值`
* 如果领域内任意一点$x$都有$f(x_0) \lt f(x)$，则称$x_0$是该函数的`严格极小值`



{% tabs 充分条件 %}
<!-- tab 费马定理下的充分条件 -->

> 费马定理

假设函数$f(x)$在$x_0$点处可导，如果在$x_0$点处取得极值，则定有$f'(x) = 0$，这一结论称为费马定理，它给出了可导函数取极值的一阶必要条件

导数等于0的点称为函数的`驻点`(Stationary Point)

最优化算法一般通过寻找函数的驻点而求解函数的极值问题，导数为0是函数取得极值的**必要条件而非充分条件**

下面给出在费马定理下的函数取极值的**充分条件**，假设函数$f(x)$在$x_0$点的一个领域内可导，且有$f'(x) = 0$，考察在$x_0$去心领域内的函数值符号，有三种情况

1. 在$x_0$的左侧$f'(x) \gt 0$，在$x_0$的右侧$f'(x) \lt 0$，则函数在$x_0$取严格极大值
2. 在$x_0$的左侧$f'(x) \lt 0$，在$x_0$的右侧$f'(x) \gt 0$，则函数在$x_0$取严格极小值
3. 在$x_0$的左侧和右侧$f'(x)$同号，则$x_0$不是极值点

对于第一种情况，函数在$x_0$的左侧单调增，在右侧单递减，因此$x_0$是极大值点；对于第二种情况，函数在$x_0$的左侧单递减，在右侧单递增，因此$x_0$是极小值点；对于第三种情况，函数在$x_0$的两侧均单调增或者单调减，因此$x_0$不是极值点

根据此结论，求函数的极值点的方法首先是求解方程$f'(x)=0$得到函数的所有驻点，然后判断驻点两侧一阶导数值的符号

<!-- endtab -->

<!-- tab 二阶导数下的充分条件 -->

利用二阶导数的信息给出函数极值的充分条件，假设$x_0$为函数的驻点，且在该点处二阶可导，对于驻点处二阶导数的符号，可分为三种情况

1. $f''(x) \gt 0$，则$x_0$为函数$f(x)$的严格极小值点
2. $f''(x) \lt 0$，则$x_0$为函数$f(x)$的严格极大值点
3. $f''(x) = 0$，则不定，$x_0$可能是极值点也可能不是极值点，需进一步讨论

情况一：如果n是偶数，则$x_0$是极值点，当$f^{(n)}{x_0} \gt 0$是$f(x)$de 严格极小值点，当$f^{(n)}{x_0} \lt 0$是$f(x)$de 严格极大值点

情况二：如果n是技术，则$x_0$不是$f(x)$的极值点

该充分条件可以用泰勒公式证明
<!-- endtab -->
{% endtabs %}



> 例子

* 考虑函数$f(x)=x^2$

  其一阶导数为$f'(x)=2x$，令$f'(x)=0$可以解得其驻点为$x=0$，由于$f''(x)=2 \gt 0$，该点是函数的极小值点

* 对于函数$f(x) = -x^2$

  其一阶导数为$f'(x) = -2x $，令$f'(x)=0$可以解得其驻点为$x=0$，由于$f''(x)=-2 \lt 0$，该点是函数的极大值点

* 对于函数$f(x)=x^3$

  其一阶导数为$f'(x)=3x^2$，令$f'(x)=0$可以解得其驻点为$x=0$

  其二阶导数为$f''(x)=6x$

  其三阶导数为$f^{(3)}(x)=6$

  由于$f''(0)=0$，$f^{(3)}(0)=6$，因此该点不是极值点

最后一种情况称为`鞍点`，会导致数值优化算法，如梯度下降无法找到真正的极值点



## 导数与函数的凹凸性

{% note primary modern %}凹凸性是函数的另一个重要性质，它与单调性共同决定了函数曲线的形状{% endnote %}

{% tabs 充分条件 %}
<!-- tab 凸函数定义 -->

对于函数$f(x)$在它的定义域内有两点$x$、$y$，如果对于任意的实数$ 0 \le \theta \le 1$都满足如下不等式
$$
f(\theta x + (1-\theta)y) \le \theta f(x) + (1-\theta)f(y)
$$
即函数为`凸函数`，从图像上看，如果函数为凸函数，那么它是向下凸的，用直线连接函数上任何两点(即两点的割线)，线段上的点都在函数曲线的上方，如图所示

![凸函数示例](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/凸函数示例.svg)

<!-- endtab -->

<!-- tab 凹函数定义 -->

如果满足不等式
$$
f(\theta x + (1-\theta)y) \ge \theta f(x) + (1-\theta)f(y)
$$
则称为`凹函数`，需要强调的是，这里遵循的是欧美国家的定义，与国内某些高等数学教材定义刚好相反

<!-- endtab -->
{% endtabs %}

> 证明凸函数定义

对于$ \forall x,y $以及$ 0 \le \theta \le 1$有
$$
f(\theta x + (1-\theta)y) = (\theta x + (1-\theta)y)^2  \\
\theta f(x) + (1-\theta)f(y) = \theta x^2 + (1-\theta)y^2
$$
显然有
$$
\theta x^2 + (1-\theta)y^2-(\theta x + (1-\theta)y)^2 = \theta(x^2-y^2)+y^2 - (\theta x+(1-\theta)y)^2 \\
= \theta(x+y)(x-y)+(y+\theta x + (1-\theta )y)(y-\theta x - (1-\theta)y) \\
= \theta(x+y)(x-y)+(\theta x+(2-\theta)y)(-\theta x+\theta y) \\
= \theta(x-y)(x+y-\theta x -(2-\theta)y) = \theta(1-\theta)(x-y)(x-y) \ge 0
$$
因此有
$$
f(\theta x+(1-\theta)y) \le \theta f(x)+(1-\theta)f(y)
$$
如果把式中的等号去掉，则称函数式`严格凸函数`，类似的可以定义`严格凹函数`

> 二阶可导函数是凸函数和凹函数的充分必要条件

假设$f(x)$在区间$[a,b]$内连续，在区间$(a,b)$内一阶导数和二阶导数均存在

* 如果在$(a,b)$内$f''(x) \ge 0$，则称函数在$[a,b]$内为凸函数
* 如果在$(a,b)$内$f''(x) \le 0$，则称函数在$[a,b]$内为凹函数
* 如果在$(a,b)$内$f''(x) > 0$，则称函数在$[a,b]$内为严格凸函数
* 如果在$(a,b)$内$f''(x) < 0$，则称函数在$[a,b]$内为严格凹函数

> 拐点

函数凹凸性的分界点称为`拐点`，如果函数二阶可导，则在拐点处有$f''(x)=0$，且在拐点处两侧二阶导数值异号

对于函数$f(x)=x^3$，其二阶导数为$6x$，$0$点处二阶导数值为$0$，且在$0$点两侧的二阶导数值异号，因此$0$为其拐点

![凸函数拐点](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/凸函数拐点.svg)


凸函数有良好的的性质，可以保证优化算法找到函数的极小值点



# 微分中值定理

{% note primary modern %}微分中值定理建立了导数与函数值之间的关系{% endnote %}

{% tabs 充分条件 %}
<!-- tab 罗尔中值定理 -->

> 定义

罗尔中值定理(Rolle Mean Value Theorem)是指如果函数$f(x)$在闭区间$[a,b]$内连续，在开区间$(a,b)$内可导，且在区间的两个端点处的值相等，即$f(a)=f(b)$，则在区间$[a,b]$内至少存在一点$\xi$使得$f'(\xi)=0$

举一个罗尔中值定理的示例: $f(x)=sin(x)$，考虑间$[0,\pi]$，有$f(0)=f(\pi)=0$，函数在$x=\frac{\pi}{2}$处有极大值，显然在该点处导数值为$0$

![罗尔中值定理示例](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/罗尔中值定理示例.svg)


> 用费马定理证明罗尔中值定理

如果$f(x)$在闭区间$[a,b]$内是常数，则在该区间内任一点处都有$f'(x)=0$

如果不为常数，则必定存在极大值点和极小值点，根据连续函数的性质，极大值和极小值中至少有一个区间$(a,b)$内取得，在该点处有$f'(x)=0$

> 几何意义

对于区间两个端点处的函数值相等的函数，在区间内至少存在一点的导数值为$0$，该点处的切线与$x$轴平行

<!-- endtab -->

<!-- tab 拉格朗日中值定理 -->

> 定义

拉格朗日中值定理(Lagrange Mean Value Theorem)是指如果函数$f(x)$在闭区间$[a,b]$内连续，在开区间$(a,b)$内可导，则在区间$(a,b)$内至少存在一点$\xi$使得
$$
f'(\xi) = \frac{f(b)-f(a)}{b-a}
$$
这是罗尔中值定理的推广

> 证明

构造辅助函数$g(x)=f(x)-\frac{f(b)-f(a)}{b-a}(x-a)$，显然有
$$
g(a)=f(a)-\frac{f(b)-f(a)}{b-a}(a-a)=f(a) \\
g(b)=f(b)-\frac{f(b)-f(a)}{b-a}(b-a)=f(a)
$$
且$g'(x)=f'(x)-\frac{f(b)-f(a)}{b-a}$，$g(x)$满足罗尔中值定理

因此在$(a,b)$内至少存在一点$\xi$使得$g'(\xi)=f'(\xi)-\frac{f(b)-f(a)}{b-a}=0$

其直观解释是将函数减掉一个线性函数，构造出两个端点的值相等的函数，以满足罗尔中值定理的条件

> 几何意义

区间$(a,b)$内至少存在一个点$\xi$，在$(\xi,f(\xi))$处的切线与两点之间的割线平行，即斜率相等

考虑函数$f(x)=x^2$，它经过$(0,0)$与$(1,1)$这两个点，因此在区间$(0,1)$内至少存在某一点$\xi$，使得$f'(\xi)=\frac{f(1)-f(0)}{1-0}$，在这里$\xi=0.5$，在该点处切线与经过$(0,0)$与$(1,1)$这两个点的割线平行，如图所示

![拉格朗日中值定理示例](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/拉格朗日中值定理示例.svg)


> 用拉格朗日中值定理证明函数的一阶导数与其单调性的关系

假设函数$f(x)$在$[a,b]$内连续，在$(a,b)$内可导。如果在$(a,b)$内所有的点处均有$f'(x)>0$，则函数在$[a,b]$内单调递增

对于区间内任一的点$x_1$，$x_2$，存在一点$x_1 < \xi < x_2$，使得$f(x_2)-f(x_1)=f'(\xi)(x_2-x_1)$

这里$f'(\xi)>0$，由于$x_1<x_2$，因此$f(x_2)-f(x_1)>0$函数单调递增

对于单调递减的情况可以用相同的方法证明

<!-- endtab -->

<!-- tab 柯西中值定理 -->

> 定义

函数$f(x)$和$g(x)$在$[a,b]$内连续，在$(a,b)$内可导，且对$\forall x \in (a,b)$有$g'(x) \neq 0$，则存在$\xi \in (a,b)$使得
$$
\frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)}
$$

> 借助罗尔中值定理证明

构造辅助函数$F(x)=f(x)-f(a)-\frac{f(b)-f(a)}{g(b)-g(a)}(g(x)-g(a))$，显然有$F(a)=F(b)=0$

且$F'(x)=f'(x)-\frac{f(b)-f(a)}{g(b)-g(a)}(g'(x))$，根据罗尔中值定理，存在$\xi \in (a,b)$使得$F'(\xi)=f'(\xi)-\frac{f(b)-f(a)}{g(b)-g(a)}g'(\xi)=0$

因此柯西中值定理成立

<!-- endtab -->

{% endtabs %}



# 泰勒公式

> 定义

如果一个函数足够光滑且在某点出各阶导数均存在，泰勒公式(Taylor's Formula)以该点处的各阶导数作为系数，构造出多项式来近似函数在该点领域中任意点处的函数值，此多项式称为`泰勒公式`

{% tabs 充分条件 %}
<!-- tab 带皮亚诺(Peano)余项的泰勒公式 -->

根据微分的定义，如果$f(x)$在点$a$处可导，可用一次函数近似代替函数$f(x)$，误差是$x-a$的高阶无穷小
$$
f(x) = f(a)+f'(a)(x-a)+o(x-a)
$$
下面将一次函数推广到更高次的多项式，如果函数$n$阶可导，则可以建立一个如下形式的多项式近似代替$f(x)$
$$
p(x) = A_0+A_1(x-a)+\cdots+A_n(x-a)^n
$$
满足$f(x)=A_0+A_1(x-a)+\cdots+A_n(x-a)^n+o((x-a)^n)$，误差项是$(x-a)^n$的高阶无穷小

下面确定多项式的系数，首先令$x=a$，含有$x-a$各项的值均为$0$，可以解得$A_0=f(a)$

接下来对$f(x)$两边同时求导得$f'(x)=A_1+2A_2(x-a)+\cdots +nA_n(x-a)^{n-1}+o((x-a)^{n-1})$

令$x=a$，可以解得$A_1=f'(a)$

以此类推，对$f(x)$两边同时求$m$阶导数，并令$x=a$，可以解得$A_m = f'(a)$

因此我们要找的多项式为
$$
p(x)=f(a)+\frac{f'(a)}{1!}(x-a)+\frac{f''(a)}{2!}(x-a)^2+\cdots + \frac{f^{n}(a)}{n!}(x-a)^n
$$
称为**泰勒多项式(Taylor polynomial)**，由此得到`带皮亚诺(Peano)余项的泰勒公式`
$$
f(x)=f(a)+\frac{f'(a)}{1!}(x-a)+\frac{f''(a)}{2!}(x-a)^2+\cdots + \frac{f^{n}(a)}{n!}(x-a)^n+o((x-a)^n)
$$
<!-- endtab -->
<!-- tab 带拉格朗日余项的泰勒公式 -->

如果令$\Delta x=x-a$，泰勒公式可以写成
$$
f(a+\Delta x)=f(a)+\frac{f'(a)}{1!}\Delta x+\frac{f''(a)}{2!}\Delta x^2+\cdots +\frac{f^{n}(a)}{n!}\Delta x^n+o(\Delta x^n)
$$
如果函数$n+1$阶可导，借助`柯西中值定理`可以证明泰勒公式的另一种形式，称为`带拉格朗日余项的泰勒公式`
$$
f(x)=f(a)+\frac{f'(a)}{1!}(x-a)+\frac{f''(a)}{2!}(x-a)^2+ \cdots + \frac{f^{n}(a)}{n!}(x-a)^{n}+\frac{f^{n+1}(a)}{(n+1)!}(x-a)^{n+1}
$$
其中$\theta \in (a,x)$，两种泰勒公式可以统一写成
$$
f(x)=f(a)+\frac{f'(a)}{1!}(x-a)+\frac{f''(a)}{2!}(x-a)^2+ \cdots + \frac{f^{n}(a)}{n!}(x-a)^{n}+R_n(x)
$$
其中$R_n(x)$称为`余项`，是$(x-a)^n$的高阶无穷小

<!-- endtab -->

{% endtabs %}

> 麦克劳林(Maclaurin)公式

函数在$x=0$点处的泰勒公式称为`麦克劳林(Maclaurin)公式`，为如下形式
$$
f(x)=f(0)+\frac{f'(0)}{1!}x+\frac{f''(0)}{2!}x^2+ \cdots + \frac{f^{n}(0)}{n!}x^{n}+R_n(x)
$$
下面列出经典的麦克劳林公式

| 函数             | 麦克劳林公式                                                 |
| ---------------- | ------------------------------------------------------------ |
| $\frac {1}{1-x}$ | $1+x+x^2+ \cdots + x^n + o(x^n)$                             |
| $e^x$            | $1+x+\frac {x^2}{2!}+\cdots +\frac {x^n}{n!}+o(x^n)$         |
| $sin(x)$         | $x-\frac {x^3}{3!}+ \cdots + \frac {(-1)^{n-1}}{(2n-1)!}x^{2n-1}+o(x^{2n-1})$ |
| $cos(x)$         | $1-\frac {x^2}{2!}+\frac {x^4}{4!}- \cdots +\frac {(-1)^n}{(2n)!}x^{2n}+o(x^{2n})$ |
| $ln(1+x)$        | $x-\frac {x^2}{2}+\frac {x^3}{3}- \cdots + \frac {(-1)^{n+1}}{n}x^n+o(x^n)$ |

泰勒公式建立了可导函数与其各阶导数之间的联系，同时用多项式对函数进行逼近

它被用于对函数的分析与计算，包括梯度下降法、牛顿法、拟牛顿法等

> 利用泰勒公式可以证明极值判别法则

将$f(x)$在$x_0$点处做泰勒展开，如果$f^{(i)}(x_0)=0,i=1,\cdots, n-1$，同时$f^{(n)}(x_0) \neq 0$，则泰勒展开的结果为
$$
f(x)=f(x_0)+\frac{f^n(x_0)}{n!}(x-x_0)^n+o((x-x_0)^n)
$$
如果$n$为偶数，则在$x_0$的去心领域内忽略高阶无穷小，有$f(x)-f(x_0)=\frac{f^n(x)(x_0)}{n!}(x-x_0)^n$

由于$(x-x_0)^n > 0$，所以$\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$与$\frac {f^{(n)}(x_0)}{n!}$，总为正或总为负，因$x_0$是极值点

如果$n$为奇数，则$\frac{f^n(x)(x_0)}{n!}(x-x_0)^n$在$x_0$的两侧变号，因此$x_0$不是极值点



# 不定积分

不定积分是积分学的核心概念，可看作求导和微分的逆运算，同样将一个函数变换成另外一个函数，称为`原函数`

> 不定积分的定义

对于定义在区间$[a,b]$内的函数$f(x)$，如果存在一个区间$(a,b)$内可导的函数$F(x)$，对于任意的$x \in (a,b)$均有$F'(x)=f(x)$

则称$F(x)$是$f(x)$的一个`原函数`，也称为`不定积分`

不定积分是求导和微分的逆运算，记为$\int f(x)dx $，意为求和(sum)

如果$F(x)$是$f(x)$的一个原函数，则$F(x)+C$也是$f(x)$的原函数，其中$C$为任意常数

因此**不定积分与原函数的关系**为：$\int f(x)dx=F(x)+C$

这是因为$(F(x)+C)'=F'(x)=f(x)$

如果函数$f(x)$的原函数存在，则称其`可积`，如果函数在区间$[a,b]$内连续，则其原函数存在，**连续是可积的充分条件**

一切初等函数在其定义域内都是连续的，因此都是可积的

对于函数$f(x)=x^2$其不定积分为$\int x^2dx=\frac{1}{3}x^3+C$

对于常数函数$f(x)=c$， 不定积分为线性函数(一次函数)$\int cdx = cx+C$

> 不定积分的性质

* 对于加法运算
  $$
  \int (f(x)+g(x))dx = \int f(x)dx + \int g(x)dx
  $$

* 对于乘法运算
  $$
  \int kf(x)dx = k \int f(x)dx
  $$

其中$k$是个常数，这些结论可以根据求导公式得到

> 计算$\int tan^2(x)dx$

根据三角函数之间的关系有
$$
\int tan^2(x)dx=\int \frac{1-cos^2(x)}{cos^2(x)}dx= \int \frac{1}{cos^2(x)}dx-\int 1dx=tan(x)-x+C
$$

> 计算$\int \frac{1}{(x-a)(x-b)}dx$

对分式进行拆分，可以得到
$$
\int \frac{1}{(x-a)(x-b)}dx=\int \frac {1}{a-b}(\frac {1}{x-a} - \frac {1}{x-b})dx \\
= \frac {1}{a-b}(\int \frac{1}{x-a}dx + \int \frac{1}{x-b}dx)= \frac {1}{a-b} (ln|x-a|+ln|x-b|)+C
$$

> 基本函数的积分公式

| 函数       | 积分公式                                                     |
| ---------- | ------------------------------------------------------------ |
| 常数函数   | $\int a dx = ax+C $                                          |
| 幂函数     | $\int x^a dx = \frac {1}{a+1}x^{a+1}+C, a \neq -1$           |
| 幂函数     | $\int \frac {1}{x} dx = ln \vert x \vert +C$                 |
| 指数函数   | $\int e^x dx = e^x+C $                                       |
| 指数函数   | $\int a^x dx = \frac {1}{ln(a)}a^x+C,a>0,a \neq1$            |
| 三角函数   | $\int sin(x) dx = -cos(x)+C$                                 |
| 三角函数   | $\int cos(x) dx = sin(x) + C$                                |
| 三角函数   | $\int tan(x)dx = -ln \vert cos(x) \vert +C $                 |
| 三角函数   | $\int cot(x)dx = ln \vert sin(x) \vert +C$                   |
| 三角函数   | $\int \frac{1}{cos^2(x)} dx = tan(x)+C$                      |
| 三角函数   | $\int \frac{1}{sin^2(x)} dx = -cot(x)+C$                     |
| 反三角函数 | $\int \frac {1}{\sqrt{1-x^2}}dx = arcsin(x) + C = -arccos(x) + C$ |
| 反三角函数 | $\int \frac {1}{1+x^2}dx = arctan(x)+C$                      |

{% tabs 充分条件 %}

<!-- tab 换元积分法之凑微分法 -->

换元法分为两种类型，第一种称为`凑微分法`，也称为第一类换元法

根据复合函数求导公式有$(F(u(x)))'=F'(u(x))u'(x)$，如果有$(F(u(x)))'=f(u(x))u'(x)$

根据不定积分的定义可以得到$\int f(u(x))u'(x)dx=F(u(x))$，由于$\int f(u)dx=F(u)$，因此有
$$
\int f(u(x))u'(x)dx = \int f(u)du
$$
这种方法的关键是将被积函数写成一个函数$f(u(x))$与另一个函数的导数$u'(x)$的乘积

> 计算不定积分$\int x cos(x^2+1)dx$

这种方法的关键是"凑出"所需要的复合函数的微分，这里凑出$x^2+1$
$$
\int x cos(x^2+1)dx = \int \frac {1}{2}cos(x^2+1)d(x^2+1) = \frac {1}{2}sin(x^2+1)
$$

> 计算不定积分$\int x e^{x^2}dx$

$$
\int x e^{x^2}dx = \frac {1}{2} \int e^{x^2}dx^2 = \frac {1}{2}e^{x^2}+C
$$

<!-- endtab -->

<!-- tab 换元积分法之变量替换法 -->

第二种换元法称为`变量替换法`，同样根据复合函数的求导公式求出

对于不定积分$\int f(x)dx$，令$x=u(t)$，如果$u(t)$在区间$I$内单调且可导，反函数$t=u^{-1}(x)$存在，则有$\int f(x)dx = \int f(u(t))du(t)$

在右侧积出之后，用$t=u^{-1}(x)$将$t$替换回$x$即可

> 计算积分$\int \frac {1}{1+\sqrt(x)} dx$

这里主要困难是$\sqrt{x}$，因此令$t= \sqrt {x}$，则有$x=t^2$，从而有
$$
\int \frac {1}{1+\sqrt(x)} dx = \int \frac{1}{1+t}dt^2 = \int \frac {2t}{1+t}dt = 2 \int (1- \frac {1}{1+t})dt \\
= 2t -2ln|1+t|+C = 2 \sqrt {x}-2ln|1+\sqrt {x}|+C
$$

> 计算积分$\int arcsin(x)dx$

令$t=arcsin(x)$，则$x=sin(t)$，从而有
$$
\int arcsin(x)dx = \int t d(sin(t)) = t sin(t) - \int sin(t)dt \\
tsin(t)+cos(t)+C = x arcsin(x)+\sqrt{1-x^2}+C
$$
这里的第二步用了分部积分法

> 计算积分$\int \sqrt {a^2-x^2}dx$

令$x=asin(t)$，利用倍角公式有
$$
\int \sqrt{a^2-x^2}dx = \int \sqrt{a^2-a^2sin^2(t)}dasin(t) = a^2 \int cos^2(t) dt \\
 = a^2 \int \frac {1+cos(2t)}{2} dt = a^2 (\frac {1}{2}t + \frac {1}{4}sin(2t))+C = a^2 (\frac {1}{2}arcsin \frac {x}{a}  + \frac {1}{2} sin(t)cos(t) )+C \\
= \frac {1}{2} a^2 arcsin(\frac {x}{a} ) + \frac {1}{2} \sqrt {a^2-x^2}+C
$$
**换元法的核心**是确定要替换的部分

<!-- endtab -->

<!-- tab 分部积分法 -->

分部积分法由乘法求导公式导出，根据乘法的求导公式$(f(x)g(x))' = f'(x)g(x) + f(x)g'(x)$，变形后得到

$f(x)g'(x) = (f(x)g(x))' - f'(x)g(x)$，两边同时求积分得到
$$
\int f(x)g'(x)dx = f(x)g(x) - \int f'(x)g(x)dx
$$

> 计算$\int x^2cos(x)dx$

$$
\int x^2 cos(x)dx = \int x^2 d sin(x)=x^2 sin(x)-\int sin(x)dx^2 = x^2sin(x)-2 \int xsin(x)dx \\
= x^2sin(x)+2\int xd(cos(x))+x^2sin(x)+2xcos(x)-2 \int cos(x)dx \\
= x^2sin(x)+2xcos(x)-2sin(x)+C
$$

`初等函数`是由幂函数、指数函数、对角函数、三角函数、反三角函数与常数经过有限次有理运算及有限次复合所产生，并且能用一个解析式表示的函数，因此初等函数的导数仍是初等函数，但初等函数的原函数不一定是初等函数

例如$e^{-x^2}$、$\frac {sin(x)}{x}$、$\frac {1}{ln(x)}$这些函数的不定积分都无法得到解析表达式

`刘维尔定理`之处，一个初等函数如果有初等的原函数，则它一定能写成同一个微分域的函数加上该域上函数的对数的线性组合，否则不存在初等的原函数

<!-- endtab -->

{% endtabs %}

在python中，符号计算库`sympy`提供了计算不定积分的功能，由函数`integrate`实现

```python
from sympy import *
x = symbols('x')
r = integrate(cos(x), x)
print(r)

>>>> sin(x)  # 这里忽略常数C
```



# 定积分

## 定积分的定义与性质

> 定义

定积分将函数映射成实数，是和式的极限，它最初用于解决几何物理问题，如计算函数曲线围成的面积、曲线长度、运动物体的位移等

常见的有`黎曼积分`和`勒贝格积分`，这里只介绍前者，也就是通常所说的**定积分**，勒贝格积分知识可以阅读`实变函数教材`

函数$f(x)$在区间$[a,b]$上的定积分是下面的极限
$$
\lim _{\Delta x \rightarrow 0} {\sum _{i=1}^{n}{f(\xi _i) \Delta x_i}}
$$
这里用一系列点$$ a = x _0,x _1 \cdots ,x _n = b $$将区间$ [a,b] $划分成$ n $分，第$ i $份的区间长度为$$ \Delta x_i = x_i - x_{i-1} $$，$$ \xi _i $$为第$i$个区间$$ [x_{i-1}, x_i] $$内任意一点

只要划分的足够细且函数$f(x)$满足一定的条件，则式中的极限存在，式中的定积分记为$\int _a^b{f(x)dx}$

若式中的极限存在，则称函数在区间$[a,b]$内`可积`

> 几何意义

定积分的几何意义是函数在某一区间上与横轴围城的区域面积

![定积分的几何意义](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/定积分的几何意义.svg)


在计算时采用逐步逼近取极限的方法，右侧的和记为矩形条的面积之和

矩形的宽度为$$\Delta x_i$$，高度为$$[x_{i-1}, x_i]$$内任意一点$$\xi _i$$的函数值$f(\xi _i)$

> 定积分存在条件

定积分存在条件是函数几乎处处连续，不连续点的测度为$0$

直观的解释是不连续点的结合是有限集或无限可数集

> 根据定积分定义计算$\int _0 ^1 {x^2 dx}$

利用下面的公式
$$
\sum _{i=1}^{n}{\frac {1}{6}n(n+1)(2n+1)}
$$
将区间$[0,1]$等分为$n$份，$\Delta x_i = \frac {1}{n}$，根据定积分的定义有
$$
\int _0^1 {x^2 dx} = \lim _{x \rightarrow +\infty}{\sum _{i=1}^{n} \frac {1}{n} {(\frac {i}{n})}^2} = \lim _{x \rightarrow +\infty}\frac {1}{n^3} \sum _{i=1}^n {i^2} = \lim _{x \rightarrow +\infty}\frac {1}{n^3} \frac {n(n+1)(2n+1)}{6} = \frac {1}{3}
$$
直接根据定义来计算定积分是繁琐困难的，后面会使用`牛顿-莱布尼茨公式`来计算

> 定积分性质

假设函数$f(x)$和$g(x)$在区间$[a,b]$内可积，$\lambda$是一个常数，则$f(x)+g(x)$与$\lambda f(x)$在区间$[a,b]$内也可积，且有

* 定积分具有线性的性质
  $$
  \int _{a}^{b}{f(x)+g(x)dx} = \int _{a}^{b}{f(x)dx} + \int _{a}^{b}{g(x)dx}
  $$

  $$
  \int _{a}^{b}{\lambda f(x)dx}= \lambda \int _{a}^{b}{f(x)dx}
  $$

* 区间可加性
  $$
  \int _{a}^{b}{f(x)dx} + \int _{b}^{c}{f(x)dx} = \int _{a}^{c}{f(x)dx}
  $$
  
* 积分上下限颠倒，积分值取负号
  $$
  \int _{a}^{b}{f(x)dx} = - \int _{b}^{a}{f(x)dx}
  $$
  

## 牛顿-莱布尼茨公式

> 牛顿-莱布尼茨(Newton-Leibniz)公式

直接根据定义来计算定积分是繁琐困难的，更高效的方法是利用微积分基本定理，即`牛顿-莱布尼茨公式`来计算

{% note primary modern %}牛顿-莱布尼茨公式建立了定积分与原函数之间的关系{% endnote %}

如果函数$f(x)$在区间$[a,b]$内可积，则在此区间内定积分的值等于其原函数在区间两个端点处函数值之差
$$
\int _{a}^{b} {fx(dx)} = F(b) - F(a)
$$
其中$F(x)$是$f(x)$的一个原函数，通常将$F(b)-F(a)$记为$F(x)|_{a}^{b}$，该公式也可以写成
$$
\int _{a}^{b}{f(x)dx} = F(x)|_{a}^{b}
$$
可以用拉格朗日中值定理证明该定理，根据定积分的定义有
$$
F(b)-F(a) = \sum _{i=1}^{n}{F(x_i)F(x_{i-1})} = \sum _{i=1}^{n}{F'(\eta _i)(x_i-x_{i-1})} = \sum _{i=1}^{n}{f(\eta _i) \Delta x_i} = \int _a^b{f(x)}dx
$$
这一定理为计算定积分提供了统一的依据，**是微积分中最重要的结论**

只需计算原函数，然后即可根据原函数的值计算任意区间上的定积分

> 计算定积分$\int _{0}^{\pi}{sin(x)dx} = -cos(x)| _0^{\pi} = 2$

在python中提供了计算定积分的功能，有`integrate`支持

```python
from sympy import *
x = symbols('x')
r = integrate(cos(x), x, -pi, pi)
print(r)

>>>> 0
```

## 定积分的计算

定积分的计算可以借助`牛顿-莱布尼茨`公式完成，因此问题的核心是计算不定积分，同样可以使用`换元法`和`分部积分法`

{% tabs 充分条件 %}

<!-- tab 换元积分法之凑微分法 -->

第一类换元法通过凑微分法得到原函数，在计算定积分时，直接积分上下限带入原函数即可得到结果，
$$
\int _{0}^{1}{xe^{x^2}dx} = \int _{0}^{1}{\frac {1}{2}e^{x^2}dx^2} = \frac {1}{2}e^{x^2}|_0^1 = \frac {1}{2}e - \frac {1}{2}
$$
<!-- endtab -->

<!-- tab 换元积分法之变量替换法 -->

第二类换元法，由于进行了变量替换，因此**积分上下限要进行相应的变换**

假设函数$f(x)$在区间$[a,b]$内可积，令$x = \varphi (t)$是一个单调函数，且$\varphi (\alpha) = a, \varphi (\beta) = b$，对于第二类换元法有
$$
\int _{a}^{b}{f(x)dx} = \int _{\alpha}^{\beta}{f(\varphi (t)) d(\varphi (t))}
$$
或者写成
$$
\int _{a}^{b}{f(x)dx} = \int _{\alpha}^{\beta}{f(\varphi (t)) \varphi' (t) d(t)}
$$

> 用换元法计算$\int _{0}^{1}{\sqrt {1-x^2} dx}$

如果令$x=sin(t)$，则有
$$
\int _{0}^{1}{\sqrt {1-x^2} dx} = \int _{0}^{\frac {\pi}{2}}{cos(t) d (sint(t))} = \int _{0}^{\frac {\pi}{2}}{cos^2(t) dt} = \int _{0}^{\frac {\pi}{2}} {\frac {1+cos(2t)}{2} dt} = \frac {1}{2}t + \frac {1}{4}sin(2t)| _{0}^{\frac {\pi}{2}} = \frac {\pi}{4}
$$
这恰好是$\frac {1}{4}$的单位元的面积

<!-- endtab -->

<!-- tab 分部积分法 -->

对于定积分，其分部积分法为
$$
\int _{a}^{b}{f(x)g'(x)dx} = f(a)g(x)|_a^b - \int _{a}^{b}{f'(x)g(x)dx}
$$

> 用分部积分法计算例子

$$
\int _{0}^{\pi}{xsin(x)dx} = -\int _{0}^{\pi}{x d(cos(x))} = -x cos(x)|_0^{\pi}+\int _{0}^{\pi}{cos(x)ds} = \pi
$$

<!-- endtab -->

{% endtabs %}

{% note primary modern %}重要结论，该结论在`欧拉-拉格朗日方程`推导中使用{% endnote %}

假设函数$f(x)$在区间$[a,b]$内连续，函数$\eta (x)$满足端点值约束条件$\eta (a) = \eta (b) = 0$，如果对任意$\eta (x)$都有
$$
\int _{a}^{b}{\eta (x) dx} = 0
$$
则$f(x) \equiv 0$

这里用`反证法`证明，假设函数$f(x)$不恒为$0$，由于$\eta (x)$是满足端点值约束的任意函数，可以令$\eta (x) = -f(x)(x-a)(x-b)$

显然此函数满足端点值约束条件，且在$(a,b)$内$-(x-a)(x-b) > 0$

因此有$$ \int _{a}^{b}{f(x)\eta (x)dx} = \int _{a}^{b}{-f(x)f(x)(x-a)(x-b) dx} > 0 $$

这结论与上式，因此结论成立

## 变上限积分

> 定义

**变上限积分函数是以积分上限为自变量的定积分对应的函数**

假设函数$$f(x)$$在区间$$ [a,b] $$内可积，$$ x \in [a,b] $$，则变上限积分的定义为
$$
F(X) = \int _{a} ^{x} f(u)du
$$
如果$$ G(x) $$是$$ f(x) $$的一个原函数，根据牛顿-莱布尼茨公式有$$ F(x) = G(x) - G(a)$$

`变上限积分函数是被积分函数的一个原函数`，概率论中连续型随机变量的分布函数是典型的变上限积分

假设$$ f(x) = x^2$$，则变上限积分对应的函数为$$ F(x) = \int _1^x u^2du = \frac {1}{3}u^3| _1^x = \frac {1}{3} x^3 - \frac {1}{3} $$

> 证明: 如果函数$$ f(x) $$在区间$$ [a,b] $$内连续，则变上限积分是可导的，且其导数为$$ F'(x) = (\int _0 ^x f(u)du)' = f(x) $$

假设$$ G(x) $$是$$ f(x) $$的一个原函数，则有
$$
(\int _0 ^x f(u)du)' = (G(x)-G(a))' = f(x)
$$
比如变上限积分$$ \int _a^x e^{t^2} dt $$其导数为$$ e^{x^2} $$

> 考虑变上限积分的复合函数

对于变上限积分$$ \int _a^{g(x)} f(u)du $$，根据复合函数的求导公式，其导数为
$$
\int _a^{g(x)} f(u)du = f(g(x))g'(x)
$$
比如计算变上限积分$$ \int _a^{x^2} e^{t^2} dt$$的导数值，根据上面公式可以得到$$ e^{(x^2)^2}(x^2)' =2xe^{x^4} $$

## 定积分的应用

定积分可以用于计算某些几何量和物理量，包括曲线所围成的面积、曲线的长度、运动物体的位移、变力的做功等

{% tabs 定积分的应用 %}

<!-- tab 曲线面积 -->

函数在区间内的积分值为其代数面积，即以$[a,b]$区间的两个端点、$x$轴、函数曲线围城的封闭区域的面积，带有正负号

等价于定积分$ \int _a^b f(x)dx $

> 计算椭圆$ \frac {x^2}{a^2} + \frac {y^2}{b^2} = 1$的面积

由于椭圆是对称的，因此计算出它在的第一象限内的面积，然后乘以4，即可得到整个椭圆的面积
$$
S = 4 \int _0^a ydx = 4 \int _0^a \sqrt{b^2(1- \frac {x^2}{a^2})} dx = 4b \int _0^a \sqrt{1-\frac {x^2}{a^2}}dx
$$
令$x=asin(t)$，利用倍角公式有
$$
S = 4ab \int _0 ^{\frac {\pi}{2}}{cos(t)d(sin(t))} = 4ab \int _0 ^{\frac {\pi}{2}}{cos^2(t)dt} = 2ab \int _0^{\frac {\pi}{2}}(1+cos(2t))dt = \pi ab
$$

> 假设有区间$[a,b]$内可积函数$f(x)$与$g(x)$，则由曲线$x=a$、$x=b$以及这两条曲线所围成的区域面积为$\int _a^b (f(x)-g(x))dx$

![抛物线与直线所围成的区域的面积](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/抛物线与直线所围成的区域的面积.svg)


比如计算抛物线$y=x^2$与直线$y=x$所围成的区域面积，抛物线与直线交点为$(0,0)$和$(1,1)$，因此围成的区域面积为
$$
S = \int _0^1 (x-x^2)dx = (\frac {1}{2}x^2 - \frac {1}{3}x^3) |_0^1 = \frac {1}{6}
$$


<!-- endtab -->

<!-- tab 曲线弧长 -->

> 考虑直角坐标系的情况

计算$f(x)$在区间$[a,b]$内的弧长，这可以通过折线逼近函数的曲线、累加折线的长度得到，其中实线为计算长度的曲线，虚线是用折线对曲线进行近似的结果，当划分得足够细的时候，这些折线的长度之和的极限就是曲线的弧长，用电$$a=x_0,x_1, \cdots , x_n = b$$，区间$$[_i, x_{i+1}]$$内的折线长度为
$$
\sqrt {(x_{i+1}-x_i)^2+(y_{i+1}-y_i)^2} = \sqrt {\Delta x_i^2 + \Delta y_i^2} = \sqrt {1+(\frac {\Delta y_i}{\Delta x_i})^2} \Delta x_i \approx \sqrt {1+y'^2} \Delta x_i
$$
令点$M_i = (x_i, y_i)$，则曲线的弧长为如下的极限
$$
\lim _{\Delta x \rightarrow 0} {\sum _{i=1}^{n}{|M_{i-1}M_i|}} = \lim _{\Delta x \rightarrow 0} \sum _{i=1}^{n} {\sqrt {1+y'^2} \Delta x_i}
$$
由此得到曲线在区间$[a,b]$内的弧长为如下的定积分
$$
s = \int _a^b {\sqrt{1+y'^2}dx}
$$
计算曲线$y= \frac {2}{3}x^{\frac {3}{2}}$在区间$[1,2]$内的弧长
$$
S = \int _1^2{1+((\frac {2}{3}x^{\frac {3}{2}})')^2}dx = \int _1^2{1+(x^{\frac {1}{2}})^2}dx = \int _1^2{\sqrt {1+x}}dx = \frac {2}{3}(1+x)^{\frac {3}{2}} |_1^2 = \frac {2}{3} \times (3^{\frac {3}{2}} - 2^{\frac {3}{2}})
$$
计算单位圆$x^2+y^2=1$的周长，由于圆是对称的，因此只需计算第一象限即可，第一象限的曲线为$y=\sqrt {1-x^2}$
$$
S = 4 \int _0^1 \sqrt {1+((\sqrt {1-x^2})')^2} dx = 4 \int _0^1 \sqrt {1+(-x(1-x^2)^{-\frac {1}{2}})^2} dx = 4 \int _0^1 \frac {1}{\sqrt {1-x^2}} dx = 4 arcsin(x)| _0^1 = 2 \pi
$$

> 考虑参数方程的情况

曲线的参数方程为$x = \varphi (t) \qquad y = \psi (t)$，其中$t \in [\alpha, \beta]$

假设$\varphi (t)$和$\psi (t)$在该区间上连续可导，则弧长元为
$$
ds = \sqrt {(dx)^2+(dy)^2} = \sqrt {\varphi '^2(t) + \psi '^2(t)} dt
$$
从而得到弧长的计算公式为
$$
S = \int _{\alpha}^{\beta}{\sqrt{\varphi '^2 (t) + \psi '^2 (t)} dt}
$$
计算星形线的弧长，其参数方程为$ x = a cos^3(t) \qquad y = a sin^3(t)$

![星形线的形状](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/星形线的形状.svg)


由于星形线的形状是对称的，因此只需计算第一象限的曲线弧长即可
$$
S = 4 \int _0^{\frac {\pi}{2}}{\sqrt {9a^2 cos^4(t) sin^2 (t) + 9a^2 sin^4 (t) cos^2 (t)}}dt = 4 \times \frac {3}{2} a \int _0^{\frac {\pi}{2}} {sin (2t) dt} = 6a
$$
<!-- endtab -->

{% endtabs %}

## 广义积分

> 定义

`广义积分`(Improper Integral)是定积分的推广，也称为`反常积分`

* **无穷积分**(无穷限广义积分)：积分区间为无限
* **瑕积分**(无界函数的广义积分)：积分区间有限但被积分函数无界

{% tabs 广义积分 %}

<!-- tab 无穷积分 -->

此时可以使用牛顿-莱布尼茨公式的推广，函数$f(x)$在$[a, + \infty]$内有定义且连续，$F(x)$是原函数，如果下面的极限存在
$$
\lim _{x \rightarrow + \infty} {F(x)} = F(+ \infty)
$$
则有
$$
\int _a^{+ \infty}{f(x)dx} = F(+ \infty)-F(a) = F(x) | _a ^{+ \infty}
$$
对于函数$f(x) = e ^{-x}$，在区间$[0, +\infty]$内的广义积分为

![e-x的曲线](https://pic.hycbook.com/i/hexo/bk_resources/math/机器学习_一元函数微积分/e-x的曲线.svg)

$$
\int _0^{+ \infty}{e^{-x} dx} = -e ^ {-x} | _0^{+ \infty} = lim _{x \rightarrow +\infty}{e^{-x}}+1 = 1
$$

<!-- endtab -->

<!-- tab 瑕积分 -->

考虑函数值为无限的情况，函数$f(x)$在$[a, b]$内有定义且连续，$F(x)$是原函数，如果下面的极限存在
$$
\lim _{x \rightarrow b^-}{F(x)} = F(b^-)
$$
则有
$$
\int _a^b {f(x)dx} = F(b^-)-F(a) = F(x)|_a^b
$$

> 计算函数$\int _0^1 {\frac {1}{\sqrt{1-x^2}} dx}$的广义积分


$$
\int _0^1 {\frac {1}{\sqrt{1-x^2}} dx} = arcsin(x)|_0^1 = \frac {\pi}{2}
$$
<!-- endtab -->

{% endtabs %}

对于某些连续型随机变量，如正态分布随机变量，其概率密度函数的定义区间无限

这种随机变量的数学期望和方差即为广义积分



# 常微分方程

`微分方程(Differential Equation, DE)`是含有自变量、函数与其导数的方程，方程的解是函数

普通的代数方程如二次方程、三次方程的解是实数或复数

## 基本概念

> 定义

含有自变量、函数以及函数各阶导数的方程称为`常微分方程(Ordinary Differential Equation, ODE)`，它的解是一元函数

常微分方程可以写成$f(x, y^{(n)}, \cdots, y', y) = 0$，这里$f$是一个函数，$y$是$x$的函数

比如$x^2y'' - x^3y' + 2y -4x = 0$

微分方程中出现的导数的最高阶数称为微分方程的`阶数`，上面的方程是二阶方程

如果微分方程是未知函数以及导数的一次方程，则称为`线性微分方程`，否则称为`非线性微分方程`

$n$阶线性微分方程可以写成如下的形式，其中$a_{n}(x) \neq 0$
$$
a_{n}(x)y^{(n)}+a_{n-1}(x)y^{(n-1)}+ \cdots + a_0(x)y = g(x)
$$
如果线性微分方程中未知函数项以及各阶导数项的系数都是常数，则成为`常系数线性微分方程`

比如二阶常系数线性微分方程$y''-xy'+y-4x = 0$

> 应用

微分方程在物理学重经常被使用，以力学为例

物体在自由落体时如果**不考虑空气阻力**，则只有重力加速度的作用

根据牛顿第二定律可以建立微分方程$y''= g$

其中$y$为$t$时刻的位移，$g$为重力加速度，解此方程可以得到位移函数$y(t)$

如果**考虑空气的阻力**，对于低速运动的物体，阻力大小与速度大小成正比，方向与重力的方向相反

速度是位移函数的一阶导数$y'$，加速度是位移函数的二阶导数$y''$，根据牛顿第二定律可以得到微分方程$my'' = mg -ky'$

其中$k$为常数，$m$为物体的质量，变形后可以得到$y'' + \frac {k}{m}y' -g = 0$

> 初值问题

通常情况下微分方程的解不唯一，加上限定条件可以保证解的唯一性，可以指定函数在某一点或某些点的值$y(x_0)=c_0$

或是其导数在某一点处的值$y'(x_0) = c_1$，加上这种限定条件之后称为`初值问题`

> 存在性与唯一性判别条件

并非所有微分方程的解都存在，对于初值问题，柯西-李普希茨(Cauchy-Lipschitz)定理给出了解的存在性与唯一性判别条件

即使解存在，也只有少数简单的微分方程可以求解得到解析解

在无法求得解析解时，可以利用数值计算的方法近似求解，常用的有`龙格-库塔(Runge-Kutta)法`和`理查森(Richardsoon)外推法`



## 一阶线性微分方程

在机器学习和深度学习中用到的通常是最简单的方程

> 一阶方程

对于一阶方程$y'=f(x)$，可以直接对其积分即可得到方程的解$$ y = \int f(x)dx + C$$

> 对于方程一侧只含有更高阶导数的方程$f^{(n)} = f(x)$

可以通过多次积分求解，这类称为`可积分的微分方程`

对于下面的方程$y'+ay=0$，将方程两边同乘以$e^{ax}$可得$e^{ax}y' + aye^{ax} = 0$

根据乘法的求导公式可以得到$y = Ce^{-ax}$

其中$y'+ay=0$是`齐次方程`

> 一般的方程$y' + ay = b(x)$

同样将方程两边同乘以$e^{ax}$可得$e^{ax}$可得$e^{ax}y' + aye^{ax} = e^{ax}b(x)$，即$(e^{ax}y)' = e^{ax}b(x)$

从而有$e^{ax}y = \int {e^{ax}b(x)dx} + C$，可以解得$y = e^{-ax}(\int e^{ax}b(x)dx + C)$

其中$y' + ay = b(x)$是`非齐次方程`

> 更复杂的方程

对于一阶线性微分方程$y'+a(x)y=b(x)$，将两边同乘以$e^{\int a(x)dx}$可得
$$
y'e^{\int a(x)dx} + a(x)ye^{\int a(x)dx} = b(x)e^{\int a(x)dx}
$$
即$(e^{\int a(x)dx}y) = b(x)e^{\int a(x)dx}$，因此有
$$
e^{\int a(x)dx}y = \int e^{\int a(x)dx} b(x)dx + C
$$
从而可以解得
$$
y = e^{-\int a(x)dx}(\int e^{\int a(x)dx} b(x)dx + C)
$$
这些方程的求解都利用了指数函数求导的优良性质，方程两边同乘以指数函数之后，利用乘积的求导公式，将方程左侧的两项求和转为某两个函数相乘的导数



